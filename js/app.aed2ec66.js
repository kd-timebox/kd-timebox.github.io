(function(e){function t(t){for(var a,s,o=t[0],l=t[1],c=t[2],h=0,d=[];h<o.length;h++)s=o[h],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&d.push(r[s][0]),r[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(t);while(d.length)d.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var l=n[o];0!==r[l]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={app:0},i=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0c4e":function(e,t,n){"use strict";var a=n("2e40"),r=n.n(a);r.a},1:function(e,t){},2:function(e,t){},"2e40":function(e,t,n){},3:function(e,t){},4678:function(e,t,n){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id="4678"},"51f2":function(e,t,n){"use strict";n.r(t),t["default"]=n.p+"e452c15f48fdd4b19f51a37672e837f7.csv"},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Layout",[n("Header",[n("h1",{staticClass:"layout-logo"},[e._v("KD-Box")]),n("Menu",{attrs:{mode:"horizontal",theme:"dark"},on:{"on-select":e.eventHandler}},[n("div",{staticClass:"layout-nav"},[n("Upload",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"upload",attrs:{action:"/","before-upload":e.readFileHandler}}),n("Submenu",{attrs:{name:"3"}},[n("template",{slot:"title"},[n("Icon",{attrs:{type:"ios-archive"}}),e._v(" Example data ")],1),n("MenuItem",{attrs:{name:"1-1"}},[e._v("Stocks(25.2MB)")]),n("MenuItem",{attrs:{name:"1-2"}},[e._v("Airline(10.6MB)")]),n("MenuItem",{attrs:{name:"1-3"}},[e._v("Weather(29.6MB)")]),n("MenuItem",{attrs:{name:"1-4"}},[e._v("Reading(18.5MB)")]),n("MenuItem",{attrs:{name:"1-5"}},[e._v("HardDrive(67.2MB)")])],2),n("MenuItem",{attrs:{name:"2"}},[n("Icon",{attrs:{type:"ios-cloud-upload-outline"}}),e._v(" Load data ")],1)],1)])],1),n("Content",{style:{width:"1850px",margin:"0 auto",padding:"0 50px",display:"flex",flexDirection:"row"}},[n("Card",{staticClass:"sticky-content"},[n("div",[n("Button",{staticStyle:{width:"200px"},attrs:{type:"info"},on:{click:function(t){return e.eventHandler("2")}}},[n("Icon",{attrs:{type:"ios-cloud-upload-outline"}}),e._v(" Load data ")],1),n("Poptip",{staticStyle:{width:"200px",display:"block"}},[n("Button",{staticStyle:{width:"200px"}},[e._v("Example Data")]),n("div",{staticStyle:{display:"flex","flex-direction":"column"},attrs:{slot:"content"},slot:"content"},[n("Button",{staticStyle:{width:"200px"},on:{click:function(t){return e.eventHandler("1-1")}}},[e._v("Stocks(25.2MB)")]),n("Button",{staticStyle:{width:"200px"},on:{click:function(t){return e.eventHandler("1-2")}}},[e._v("Airline(10.6MB)")]),n("Button",{staticStyle:{width:"200px"},on:{click:function(t){return e.eventHandler("1-3")}}},[e._v("Weather(29.6MB)")]),n("Button",{staticStyle:{width:"200px"},on:{click:function(t){return e.eventHandler("1-4")}}},[e._v("Reading(18.5MB)")]),n("Button",{staticStyle:{width:"200px"},on:{click:function(t){return e.eventHandler("1-5")}}},[e._v("HardDrive(67.2MB)")])],1)],1),n("Upload",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"upload",attrs:{action:"/","before-upload":e.readFileHandler}}),n("p",{staticStyle:{"margin-top":"100px"}},[e._v("Line Aggregation Attribute:")]),n("Select",{staticStyle:{width:"200px"},model:{value:e.aggregateAttr,callback:function(t){e.aggregateAttr=t},expression:"aggregateAttr"}},e._l(e.headers,(function(t,a){return n("Option",{key:a,attrs:{value:a}},[e._v(e._s(t)+" ")])})),1),n("p",[e._v("Time Attribute:")]),n("Select",{staticStyle:{width:"200px"},model:{value:e.timeAttr,callback:function(t){e.timeAttr=t},expression:"timeAttr"}},[e._l(e.headers,(function(t,a){return["string"!=e.inferTypes[a]?n("Option",{key:a,attrs:{value:a}},[e._v(e._s(t)+" ")]):e._e()]}))],2),n("p",[e._v("Value Attribute:")]),n("Select",{staticStyle:{width:"200px"},model:{value:e.valueAttr,callback:function(t){e.valueAttr=t},expression:"valueAttr"}},[e._l(e.headers,(function(t,a){return["number"==e.inferTypes[a]?n("Option",{key:a,attrs:{value:a}},[e._v(e._s(t)+" ")]):e._e()]}))],2),n("br"),n("br"),n("Button",{staticStyle:{width:"200px"},attrs:{type:"primary",disabled:!e.headers.length},on:{click:e.generateCharts}},[e._v("generate chart ")]),n("div",{staticStyle:{"margin-top":"100px"}},[n("Button",{staticStyle:{width:"200px"},attrs:{type:"primary"},on:{click:e.exportFig}},[e._v("export figure ")]),n("br"),n("Button",{staticStyle:{"margin-top":"12px",width:"200px"},attrs:{type:"primary"},on:{click:function(t){return e.exportData(1)}}},[e._v("export representative lines ")]),n("br"),n("Button",{staticStyle:{"margin-top":"12px",width:"200px"},attrs:{type:"primary"},on:{click:function(t){return e.exportData(0)}}},[e._v("export select lines ")])],1)],1)]),n("Card",{staticStyle:{"margin-left":"20px","flex-grow":"1"}},[e.headers.length?n("div",[e.chartConfigs.length?n("div",[e._l(e.chartConfigs,(function(t,a){return[n("CanvasBox",{key:t.aggregateName+"#"+t.timeName+"#"+t.valueName,attrs:{timeIndex:t.timeIndex,valueIndex:t.valueIndex,timeName:t.timeName,valueName:t.valueName,filter:t.filter,layers:e.layers},on:{filterChange:function(t){return e.handleFilterChange(a,t)}}})]}))],2):n("div",{staticStyle:{"min-height":"200px",color:"red"}},[e._v(" Please use a valid configuration in left panel! ")])]):n("div",{staticStyle:{"min-height":"200px",color:"red"}},[e._v(" Please load a dataset (.csv file) first! "),n("Button",{staticStyle:{margin:"0 12px"},attrs:{type:"primary",icon:"ios-archive"},on:{click:function(t){return e.eventHandler("1-1")}}},[e._v("Example Stocks(25.2MB) ")]),n("Button",{staticStyle:{margin:"0 12px"},attrs:{type:"primary",icon:"ios-archive"},on:{click:function(t){return e.eventHandler("1-2")}}},[e._v("Example Airline(10.6MB) ")]),n("Button",{staticStyle:{margin:"0 12px"},attrs:{type:"primary",icon:"ios-archive"},on:{click:function(t){return e.eventHandler("1-3")}}},[e._v("Example Weather(29.6MB) ")]),n("Button",{staticStyle:{margin:"0 12px"},attrs:{type:"primary",icon:"ios-archive"},on:{click:function(t){return e.eventHandler("1-4")}}},[e._v("Example Reading(18.5MB) ")]),n("Button",{staticStyle:{margin:"0 12px"},attrs:{type:"primary",icon:"ios-archive"},on:{click:function(t){return e.eventHandler("1-5")}}},[e._v("Example HardDrive(67.2MB) ")]),n("Button",{staticStyle:{margin:"0 12px"},attrs:{type:"primary",icon:"ios-cloud-upload-outline"},on:{click:function(t){return e.eventHandler("2")}}},[e._v("Load data ")])],1)])],1)],1)],1)},i=[],s=(n("99af"),n("4de4"),n("7db0"),n("4160"),n("caad"),n("c975"),n("a15b"),n("d81d"),n("13d5"),n("fb6a"),n("a434"),n("ace4"),n("4ec9"),n("4fad"),n("d3b7"),n("ac1f"),n("25f0"),n("6062"),n("2532"),n("3ca3"),n("1276"),n("2ca0"),n("cfc3"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("159b"),n("ddb0"),n("2909")),o=n("5530"),l=n("3835"),c=n("b85c"),u=n("ade3");n("b5bb"),n("9389"),n("4b31"),n("7f6b");function h(e,t,n){var a=document.createElement("canvas");a.width=1e3,a.height=500;var r=a.getContext("2d");for(var i in t&&r.scale(1,-1),console.log(n),e){var s=e[i];r.globalAlpha=n?n[i]:1,r.drawImage(s,0,t?-s.height:0)}var o=document.createElement("a");o.href=a.toDataURL().replace(/^data:image\/[^;]*/,"data:application/octet-stream"),o.download="export.png",o.click()}var d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center",margin:"15px 0 15px 20px",position:"relative"}},[n("div",{staticStyle:{width:"1000px",height:"500px",opacity:"0","pointer-events":"none"}}),n("canvas",{staticStyle:{transform:"scaleY(1)",position:"absolute",left:"0",top:"0"},attrs:{id:"canvas",width:"1000",height:"500"},on:{mousedown:e.canvasMousedown,mouseup:e.canvasMouseup,mousemove:e.canvasMousemove,wheel:e.canvasWheel,contextmenu:e.mouseContextmenu}}),n("canvas",{staticStyle:{transform:"scaleY(1)",position:"absolute",left:"0",top:"0","pointer-events":"none"},attrs:{id:"selectionCanvas",width:"1000",height:"500"}}),n("canvas",{staticStyle:{transform:"scaleY(1)",position:"absolute",left:"0",top:"0","pointer-events":"none"},attrs:{id:"selectionLayer",width:"1000",height:"500"}}),n("canvas",{staticStyle:{transform:"scaleY(1)",position:"absolute",left:"0",top:"0","pointer-events":"none"},attrs:{id:"rep_layer",width:"1000",height:"500"}}),n("canvas",{staticStyle:{transform:"scaleY(1)",position:"absolute",left:"0",top:"0","pointer-events":"none"},attrs:{id:"raw_lines",width:"1000",height:"500"}}),n("canvas",{staticStyle:{transform:"scaleY(1)",position:"absolute",left:"0",top:"0","pointer-events":"none","z-index":"999"},attrs:{id:"mouseLayer",width:"1000",height:"500"}}),n("svg",{staticStyle:{position:"absolute",left:"-30px",top:"-20px","pointer-events":"none",color:"black","z-index":"999"},attrs:{id:"axisHelper",width:"1030",height:"540"}},[n("g",{attrs:{id:"cursorHelper",transform:"translate(30,20)"}},[n("line",{attrs:{stroke:"black","stroke-dasharray":"10 5"}}),n("line",{attrs:{stroke:"black","stroke-dasharray":"10 5"}}),n("text",{attrs:{"font-size":"12px"}}),n("text",{attrs:{"font-size":"12px"}})])]),n("div",{ref:"axisTop",staticStyle:{width:"1000px",height:"30px",position:"absolute",top:"-30px",left:"0"}}),n("div",{ref:"axisBottom",staticStyle:{width:"1000px",height:"30px",position:"absolute",bottom:"-30px",left:"0"}}),n("div",{ref:"axisLeft",staticStyle:{width:"30px",height:"500px",position:"absolute",top:"0px",left:"-30px"}}),n("div",{staticClass:"control-panel"},[n("div",[n("span",[e._v("Filter line by: ")]),n("RadioGroup",{attrs:{type:"button"},model:{value:e.filterMode,callback:function(t){e.filterMode=t},expression:"filterMode"}},[n("Radio",{attrs:{label:"brush"}},[e._v("Brush")]),n("Radio",{attrs:{label:"ang"}},[e._v("Angle")]),n("Radio",{attrs:{label:"attr"}},[e._v("Attr")])],1)],1),"attr"===e.filterMode?n("div",{staticStyle:{"margin-left":"2em"}},[n("Form",[n("FormItem",{attrs:{label:"Attribute Column"}},[n("Select",{attrs:{placeholder:"Choose a column for attribute filtering"},model:{value:e.attributeColumn,callback:function(t){e.attributeColumn=t},expression:"attributeColumn"}},e._l(e.headers,(function(t){return n("Option",{key:t.title,attrs:{value:t.key}},[e._v(e._s(t.title))])})),1)],1),n("FormItem",{attrs:{label:"Value"}},[n("AutoComplete",{attrs:{data:e.attributeData},on:{"on-search":e.handleSearch},model:{value:e.attributeValue,callback:function(t){e.attributeValue=t},expression:"attributeValue"}})],1),n("Button",{staticStyle:{float:"right"},attrs:{type:"info"},on:{click:e.addAttrQuery}},[e._v("add attribute query")])],1)],1):e._e(),e._m(0),"rep"==e.rawMode?n("div",{staticStyle:{"margin-left":"2em"}},[n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("span",{staticStyle:{"margin-right":"8px"}},[e._v("Line count")]),n("Slider",{staticStyle:{"flex-grow":"1"},attrs:{min:1,max:20,step:1,"show-tip":"never"},model:{value:e.repCount,callback:function(t){e.repCount=t},expression:"repCount"}}),n("span",{staticStyle:{"margin-left":"8px"}},[e._v(e._s(e.repCount))]),n("span",{staticStyle:{"margin-right":"8px","margin-left":"12px"}},[e._v("Diverse")]),n("Slider",{staticStyle:{"flex-grow":"1"},attrs:{min:0,max:1,step:.001,"show-tip":"never"},on:{"on-change":function(t){e.cnt++}},model:{value:e.diverse,callback:function(t){e.diverse=t},expression:"diverse"}})],1),n("div",{staticStyle:{display:"flex","align-items":"center"}})]):e._e(),n("div",{staticStyle:{position:"relative"}},[n("div",{staticClass:"select-colormap"},[n("span",{staticStyle:{margin:"0"}},[e._v("Colormap:")]),n("Select",{attrs:{id:"colormap",placeholder:"Choose colormap"},model:{value:e.colormapIndexCache,callback:function(t){e.colormapIndexCache=t},expression:"colormapIndexCache"}},[n("Option",{attrs:{value:"0"}},[e._v("viridis")]),n("Option",{attrs:{value:"1",selected:""}},[e._v("magma")]),n("Option",{attrs:{value:"2"}},[e._v("inferno")]),n("Option",{attrs:{value:"3"}},[e._v("plasma")]),n("Option",{attrs:{value:"4"}},[e._v("cividis")]),n("Option",{attrs:{value:"5"}},[e._v("turbo")]),n("Option",{attrs:{value:"6"}},[e._v("bluegreen")]),n("Option",{attrs:{value:"7"}},[e._v("bluepurple")]),n("Option",{attrs:{value:"8"}},[e._v("goldgreen")]),n("Option",{attrs:{value:"9"}},[e._v("goldorange")]),n("Option",{attrs:{value:"10"}},[e._v("goldred")]),n("Option",{attrs:{value:"11"}},[e._v("greenblue")]),n("Option",{attrs:{value:"12"}},[e._v("orangered")]),n("Option",{attrs:{value:"13"}},[e._v("purplebluegreen")]),n("Option",{attrs:{value:"14"}},[e._v("purpleblue")]),n("Option",{attrs:{value:"15"}},[e._v("purplered")]),n("Option",{attrs:{value:"16"}},[e._v("redpurple")]),n("Option",{attrs:{value:"17"}},[e._v("yellowgreenblue")]),n("Option",{attrs:{value:"18"}},[e._v("yellowgreen")]),n("Option",{attrs:{value:"19"}},[e._v("yelloworangebrown")]),n("Option",{attrs:{value:"20"}},[e._v("yelloworangered")])],1)],1),n("span",[e._v("1")]),n("span",{staticClass:"color-map",attrs:{id:"color-map"}}),n("InputNumber",{staticStyle:{width:"50px"},attrs:{min:1,"active-change":!1},model:{value:e.maxDensity,callback:function(t){e.maxDensity=t},expression:"maxDensity"}})],1),e._m(1),n("div",{staticStyle:{"margin-left":"2em"}},[n("draggable",{model:{value:e.layers,callback:function(t){e.layers=t},expression:"layers"}},e._l(e.layers,(function(t){return n("div",{key:t.id,staticStyle:{display:"flex","align-items":"center",border:"1px solid #dcdee2","margin-top":"4px",background:"white",cursor:"pointer","border-radius":"4px",padding:"0 8px"}},[n("Icon",{staticStyle:{cursor:"move"},attrs:{type:"md-menu"}}),n("div",{staticStyle:{"flex-grow":"1"}},[n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("p",{staticStyle:{width:"170px","padding-left":"12px"}},[e._v(" "+e._s(t.name)+" ")]),n("Icon",{style:{opacity:.7*t.opacity+.3},attrs:{type:0===t.opacity?"md-eye-off":"md-eye"},on:{click:function(e){t.opacity=0===t.opacity?1:0}}}),n("Slider",{staticStyle:{"flex-grow":"1","margin-left":"12px","margin-right":"8px"},attrs:{min:0,max:1,step:.01,"show-tip":"never"},model:{value:t.opacity,callback:function(n){e.$set(t,"opacity",n)},expression:"layer.opacity"}})],1),"selectionCanvas"==t.id?n("div",{staticStyle:{display:"flex","align-items":"center",margin:"0 12px 8px",position:"relative"}},[n("div",{staticClass:"select-colormap"},[n("span",{staticStyle:{margin:"0"}},[e._v("Colormap:")]),n("Select",{attrs:{id:"colormapOverlay",placeholder:"Choose colormap"},model:{value:e.colormapOverlayIndexCache,callback:function(t){e.colormapOverlayIndexCache=t},expression:"colormapOverlayIndexCache"}},[n("Option",{attrs:{value:"0"}},[e._v("viridis")]),n("Option",{attrs:{value:"1",selected:""}},[e._v("magma")]),n("Option",{attrs:{value:"2"}},[e._v("inferno")]),n("Option",{attrs:{value:"3"}},[e._v("plasma")]),n("Option",{attrs:{value:"4"}},[e._v("cividis")]),n("Option",{attrs:{value:"5"}},[e._v("turbo")]),n("Option",{attrs:{value:"6"}},[e._v("bluegreen")]),n("Option",{attrs:{value:"7"}},[e._v("bluepurple")]),n("Option",{attrs:{value:"8"}},[e._v("goldgreen")]),n("Option",{attrs:{value:"9"}},[e._v("goldorange")]),n("Option",{attrs:{value:"10"}},[e._v("goldred")]),n("Option",{attrs:{value:"11"}},[e._v("greenblue")]),n("Option",{attrs:{value:"12"}},[e._v("orangered")]),n("Option",{attrs:{value:"13"}},[e._v("purplebluegreen")]),n("Option",{attrs:{value:"14"}},[e._v("purpleblue")]),n("Option",{attrs:{value:"15"}},[e._v("purplered")]),n("Option",{attrs:{value:"16"}},[e._v("redpurple")]),n("Option",{attrs:{value:"17"}},[e._v("yellowgreenblue")]),n("Option",{attrs:{value:"18"}},[e._v("yellowgreen")]),n("Option",{attrs:{value:"19"}},[e._v("yelloworangebrown")]),n("Option",{attrs:{value:"20"}},[e._v("yelloworangered")])],1)],1),n("span",[e._v("1")]),n("span",{staticClass:"color-map",attrs:{id:"color-map-overlay"}}),n("InputNumber",{staticStyle:{width:"50px"},attrs:{min:1,"active-change":!1},model:{value:e.maxOverlayDensity,callback:function(t){e.maxOverlayDensity=t},expression:"maxOverlayDensity"}})],1):e._e()])],1)})),0)],1),n("div",[n("span",[e._v("Show value of cursor:")]),n("iSwitch",{staticStyle:{"margin-left":"12px"},model:{value:e.showCursorValue,callback:function(t){e.showCursorValue=t},expression:"showCursorValue"}})],1),n("div",[n("span",[e._v("Reverse y-axis:")]),n("iSwitch",{staticStyle:{"margin-left":"12px"},model:{value:e.upsideDown,callback:function(t){e.upsideDown=t},expression:"upsideDown"}})],1),n("div",[n("span",[e._v("Normalize density:")]),n("iSwitch",{staticStyle:{"margin-left":"12px"},model:{value:e.normalizeDensity,callback:function(t){e.normalizeDensity=t},expression:"normalizeDensity"}})],1),n("div",[n("span",[e._v("Enlarge Axis Font Size:")]),n("iSwitch",{staticStyle:{"margin-left":"12px"},model:{value:e.enlargeFont,callback:function(t){e.enlargeFont=t},expression:"enlargeFont"}})],1)])]),n("Table",{staticStyle:{"margin-top":"30px"},attrs:{"row-class-name":e.calClassName,border:"",columns:e.tableColumns,data:e.cnt+1&&e.tableData,"on-current-change":e.hoveringQuery,id:"informationTable"},scopedSlots:e._u([{key:"name",fn:function(t){var a=t.row,r=t.index;return[r>=e.tableData.length-2?n("p",{staticStyle:{"font-style":"italic","font-weight":"700"}},[e._v(" "+e._s(a.name)+" ")]):n("div",[e._v(e._s(a.name))])]}},{key:"op",fn:function(t){var a=t.row,r=t.index;return[n("Button",{staticStyle:{"margin-right":"5px"},attrs:{ghost:"",type:a.query===e.selectedQuery?"primary":"default",size:"small"},on:{click:function(t){e.selectedQuery=a.query}}},[e._v("Explore ")]),r<e.tableData.length-2?n("Button",{attrs:{type:"error",size:"small"},on:{click:function(t){return e.deleteQuery(r)}}},[e._v("Delete ")]):e._e()]}}])}),n("Button",{staticStyle:{float:"right",margin:"20px"},attrs:{type:"error",size:"small"},on:{click:e.deleteAllQuery}},[e._v(" Delete all Querys ")]),n("Modal",{attrs:{width:"1000",closable:!1},model:{value:e.repModal,callback:function(t){e.repModal=t},expression:"repModal"}},[n("p",{staticStyle:{color:"dodgerblue","text-align":"center"},attrs:{slot:"header"},slot:"header"},[n("Icon",{attrs:{type:"ios-information-circle"}}),n("span",[e._v("Representative Line Information")])],1),n("Table",{attrs:{border:"",columns:e.repColumns,data:e.repStaticInformation}}),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"primary",size:"large",long:""},on:{click:function(t){e.repModal=!1}}},[e._v("Confirm")])],1)],1)],1)},f=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("span",[e._v("Representative line parameters: ")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("span",[e._v("Layers:")])])}],p=(n("cb29"),n("b0c0"),n("2af1"),n("a9e3"),n("b680"),n("07ac"),n("8a59"),n("b76a")),v=n.n(p),y={data:[],aggregatedData:[],headers:[],interResult:[],unionResult:[],querys:[],repIds:[],weightCache:{}};n("7dbb");var m=n("5698"),x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Table",{attrs:{columns:e.repColumns,data:e.row},scopedSlots:e._u([{key:"name",fn:function(t){var a=t.row;return[n("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"center","align-items":"center"}},[n("div",{staticClass:"small-point",style:{background:a.color}}),n("p",[e._v(e._s(a.name))])])]}}])})},g=[],b={name:"expandRow",props:{row:Array},data:function(){return{repColumns:[{title:'Line "'.concat(y.aggregateName,'"'),align:"center",slot:"name"},{title:"Min value",align:"center",key:"minV"},{title:"Max value",align:"center",key:"maxV"},{title:"Mean value",align:"center",key:"mean"},{title:"Variance",align:"center",key:"var"}]}},mounted:function(){console.log("this is rows",this.row)}},w=b,M=(n("72cd"),n("2877")),C=Object(M["a"])(w,x,g,!1,null,null,null),j=C.exports,k=(n("a630"),n("841c"),n("10d1"),n("1fe2"),n("d4ec")),S=n("bee2"),O=n("34d8");n("9bd1"),n("5364"),n("fa35"),n("a6c1"),n("175a"),n("ec78").default,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakSet;new WeakMap,new WeakMap,new WeakMap,new WeakSet,new WeakSet,new WeakSet,new WeakSet;function D(e,t,n){var a=Math.max(Math.min((n-e.x)/(t.x-e.x),1),0),r=1-a;return{x:e.x*r+t.x*a,y:e.y*r+t.y*a}}function L(e,t){if(e[0]===t[0])throw console.log(e,t),Error("Same x coordinate");return Math.atan((t[1]-e[1])/(t[0]-e[0]))}function _(e){return e*e}function I(e,t){return _(e[0]-t[0])+_(e[1]-t[1])}function z(e,t){return Math.abs(e-t)<=1}var A=function(e,t,n){z(e[0],t[0])&&(e[0]=n[0]),z(e[1],t[1])&&(e[1]=n[1])},B=function(e,t,n){e[0]+=t,e[1]+=n};function E(e,t){var n={x:e.x1,y:e.y1},a={x:e.x2,y:e.y2},r={x:t.x,y:t.y},i={x:t.x+t.width,y:t.y};if(T(n,a,r,i))return!0;r=i,i={x:t.x+t.width,y:t.y+t.height};if(T(n,a,r,i))return!0;r=i,i={x:t.x,y:t.y+t.height};if(T(n,a,r,i))return!0;r=i,i={x:t.x,y:t.y};return!!T(n,a,r,i)}function T(e,t,n,a){var r=(a.x-n.x)*(e.y-n.y)-(a.y-n.y)*(e.x-n.x),i=(t.x-e.x)*(e.y-n.y)-(t.y-e.y)*(e.x-n.x),s=(a.y-n.y)*(t.x-e.x)-(a.x-n.x)*(t.y-e.y);if(0==r&&0==i&&0==s)return null;if(0==s)return null;r/=s,i/=s;var o=r>=0&&r<=1&&i>=0&&i<=1;return o}function R(e){if(e.length<3)return[];for(var t=[],n=1;n<e.length-1;n++){var a=e[n].x-e[n-1].x,r=e[n+1].x-e[n].x,i=Math.min(a,r),s=(e[n+1].x,e[n].x,e[n+1].y,e[n].y,e[n].x,e[n-1].x,e[n].y,e[n-1].y,e[n-1]),o=e[n+1];a<r?o=D(e[n],o,e[n].x+a):s=D(e[n-1],e[n],e[n].x-r);var l=(o.y-s.y)/i,c=(s.y-2*e[n].y+o.y)/(i*i);t.push({x:e[n].x,y:Math.abs(c)/Math.pow(1+l*l,1.5)})}return t}function q(e,t,n){var a=0,r=0,i=0,s=0;while(i<e.length&&s<t.length)if(e[i].x<t[s].x){if(0!==s){var o=D(t[s-1],t[s],e[i].x);r+=Math.abs(o.y-e[i].y),a++}i++}else if(t[s].x<e[i].x){if(0!==i){var l=D(e[i-1],e[i],t[s].x);r+=Math.abs(l.y-t[s].y),a++}s++}else r+=Math.abs(e[i].y-t[s].y),a++,i++,s++;return 0===a?1e-4:r/a}function H(e,t,n,a){var r=Math.floor(e[1].x),i=Math.floor(e[1].y),s=Math.floor(e[0].x),o=Math.floor(e[0].y);if(r!=s)return Math.abs(i-o)>Math.abs(r-s)?i<o?P(r,i,s,o,t,n,a):P(s,o,r,i,t,n,a):r<s?Y(r,i,s,o,t,n,a):Y(s,o,r,i,t,n,a)}function Y(e,t,n,a,r,i,s){var o=Math.min(1,Math.abs(1/s));isFinite(o)&&!isNaN(o)||(o=1);for(var l=n-e,c=a-t,u=c<0?(c=-c,-1):1,h=2*c-l,d=!0,f=e,p=t;f<=n;++f,h+=2*c){var v;if(f>=0&&f<1e3&&p>=0&&p<500)d?d=!1:r[f][p][i]=(null!==(v=r[f][p][i])&&void 0!==v?v:0)+o;h>0&&(p+=u,h-=2*l)}}function P(e,t,n,a,r,i,s){var o=Math.min(1,Math.abs(1/s));isFinite(o)&&!isNaN(o)||(o=1);for(var l=n-e,c=a-t,u=l<0?(l=-l,-1):1,h=2*l-c,d=!0,f=e,p=t;p<=a;++p,h+=2*l){var v;if(f>=0&&f<1e3&&p>=0&&p<500)d?d=!1:r[f][p][i]=(null!==(v=r[f][p][i])&&void 0!==v?v:0)+o;h>0&&(f+=u,h-=2*c)}}n("5cc6"),n("84c3"),n("fb2c");var F=n("175a"),N=n.n(F),W={deg:3,b:1.128,k:5,r:.05,cuveq:.06},$={},Q=new WeakSet,X=new WeakSet,V=new WeakSet,U=new WeakSet,K=new WeakSet,G=new WeakSet,J=new WeakSet,Z=new WeakSet,ee=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;Object(k["a"])(this,e),Z.add(this),J.add(this),G.add(this),K.add(this),U.add(this),V.add(this),X.add(this),Q.add(this),Object(u["a"])(this,"root",null),Object(u["a"])(this,"segs",[]);var a={pos:void 0,cuv:void 0,offsets:void 0,sizes:void 0,fastID:void 0,lineID:[],segIndex:[]},r=t.reduce((function(e,t){return e+t.length}),0),i=t.reduce((function(e,t){return Math.max(e,t.length)}),0),s=t.length>65535?Uint32Array:Uint16Array,o=r>65535?Uint32Array:Uint16Array,l=i>65535?Uint32Array:i>127?Uint16Array:Uint8Array;a.pos=new Array(r),a.cuv=new Float32Array(r),a.fastID=new s(r),a.offsets=new o(t.length),a.sizes=new l(t.length);var h=0;t.forEach((function(e,t){a.offsets[t]=h,a.sizes[t]=e.length,e.forEach((function(n,r){a.pos[h]=n,a.fastID[h]=t,r<=0||r>=e.length-1?a.cuv[h]=0:a.cuv[h]=ce(e[r-1],n,e[r+1]),h++}))})),a.sizes.forEach((function(e,t){var r=a.offsets[t],i=e+r-1;we(r,i,n,t,a)}));var d=new Float32Array(a.pos.length);a.sizes.forEach((function(e,t){for(var n=a.offsets[t],r=e+n-1,i=n;i<r;i++){var s=ue(a.pos[i],a.pos[i+1]);d[i]=s,s}d[r]=0})),a.sizes.forEach((function(e,t){for(var n=a.offsets[t],r=e+n-1,i=n+1;i<r;i++){var s=fe(a.pos[i+1],a.pos[i]),o=fe(a.pos[i],a.pos[i-1]);a.pos[i].z=(d[i]*(s.y/s.x)+d[i-1]*(o.y/o.x))/(d[i]+d[i-1]),i===n+1&&(a.pos[n].z=o.y/o.x),i===r-1&&(a.pos[r].z=s.y/s.x)}}));var f=[],p=0;a.sizes.forEach((function(e,t){var n=a.offsets[t],r=e+n,i={aabb:void 0,from:n,to:r-1,sp:[]};f.push(i),Se(i,a.pos);var s=-1;while(p<a.segIndex.length){var o=a.segIndex[p];if(a.fastID[o[0]]<t)++p;else{if(a.fastID[o[0]]>t){--p;break}s!==o[0]&&i.sp.push(o[0]),i.sp.push(o[1]),s=o[1],++p}}}));var v=[],y=new Map;v.push(f,!1,null,0);while(v.length){var m,x=v.slice(v.length-4,v.length),g=a.pos[x[0][0].from],b=g,w=Object(c["a"])(x[0]);try{for(w.s();!(m=w.n()).done;){var M=m.value;g=ye(M.aabb.a,g),b=me(M.aabb.b,b)}}catch(He){w.e(He)}finally{w.f()}for(var C=fe(b,g),j=[],S=[],O=Ce(x[0]),D=!1,L=0,_=0,I=x[3],z=I>2?0:I,A=I>2?2:I,B=z;B<=A;B++)if(!(C[ke(L)]<2*W.r)){L=B;var E,T=[],R=Object(c["a"])(x[0]);try{for(R.s();!(E=R.n()).done;){for(var q,H,Y=E.value,P=Y.from+1;P<Y.to;P++){var F,N=null!==(F=a.pos[P][ke(L)])&&void 0!==F?F:0;T.push([N])}var $=null!==(q=a.pos[Y.from][ke(L)])&&void 0!==q?q:0,ee=null!==(H=a.pos[Y.to][ke(L)])&&void 0!==H?H:0;T.push([$]),T.push([ee])}}catch(He){R.e(He)}finally{R.f()}_=je(T,.5),j=[],S=[],Oe(L,_,x[0],j,S,a);var te=Ce(j),ne=Ce(S),ae=j.length,re=S.length,ie=(_-g[ke(L)])/C[ke(L)],se=_e(te,ne,O,ie,0,0);if(se<O&&ae>=W.k&&re>=W.k&&C[ke(L)]*ie>W.r&&C[ke(L)]*(1-ie)>W.r){D=!0;break}}if(D){var oe={dim:L,pos:_};null===x[2]?this.root=oe:Ie(x[2],oe,x[1]),v.pop(),v.pop(),v.pop(),v.pop(),v.push(j,!0,oe,x[3]+1,S,!1,oe,x[3]+1)}else{this.segs.length;var le,he={segs:[]},de=Object(c["a"])(x[0]);try{for(de.s();!(le=de.n()).done;){var pe,ve=le.value,xe=ve.from,ge=Object(c["a"])(ve.sp);try{for(ge.s();!(pe=ge.n()).done;){var be=pe.value;if(xe!=be){var Me="".concat(a.pos[xe].x,"-").concat(a.pos[be].x,"-").concat(a.fastID[be]),De=y.get(Me);if(void 0!==De)he.segs.push(De);else{var Le=fe(a.pos[be],a.pos[xe]),ze=[a.pos[xe],a.pos[be],Le.y/Le.x,a.fastID[be]],Ae=this.segs.length;this.segs.push(ze),he.segs.push(Ae),y.set(Me,Ae)}xe=be}}}catch(He){ge.e(He)}finally{ge.f()}if(xe!=ve.to){var Be="".concat(a.pos[xe].x,"-").concat(a.pos[ve.to].x,"-").concat(a.fastID[ve.to]),Ee=y.get(Be);if(void 0!==Ee)he.segs.push(Ee);else{var Te=fe(a.pos[xe],a.pos[ve.to]),Re=[a.pos[xe],a.pos[ve.to],Te.y/Te.x,a.fastID[ve.to]],qe=this.segs.length;this.segs.push(Re),he.segs.push(qe),y.set(Be,qe)}}}}catch(He){de.e(He)}finally{de.f()}this.segs.length;null===x[2]?this.root=he:Ie(x[2],he,x[1]),v.pop(),v.pop(),v.pop(),v.pop()}}}return Object(S["a"])(e,[{key:"knn",value:function(e,t){$={};var n=new N.a((function(e,t){return t.value-e.value}));return Object(O["a"])(this,Q,te).call(this,n,{x:e[0],y:e[1]},t,this.root),n.toArray()}},{key:"rnn",value:function(e,t){var n={};return Object(O["a"])(this,U,re).call(this,n,{x:e[0],y:e[1]},t,this.root),Object.values(n)}},{key:"brush",value:function(e,t){var n=new Set;Object(O["a"])(this,G,se).call(this,n,{x:e[0],y:e[1],z:-1/0},{x:t[0],y:t[1],z:1/0},{a:{x:-1/0,y:-1/0,z:-1/0},b:{x:1/0,y:1/0,z:1/0}},this.root);var a=new Set;return Object(O["a"])(this,G,se).call(this,a,{x:e[0],y:e[1]-1,z:-1/0},{x:t[0],y:e[1],z:1/0},{a:{x:-1/0,y:-1/0,z:-1/0},b:{x:1/0,y:1/0,z:1/0}},this.root),Object(O["a"])(this,G,se).call(this,a,{x:e[0],y:t[1],z:-1/0},{x:t[0],y:t[1]+1,z:1/0},{a:{x:-1/0,y:-1/0,z:-1/0},b:{x:1/0,y:1/0,z:1/0}},this.root),Object(s["a"])(n).filter((function(e){return!a.has(e)}))}},{key:"angular",value:function(e,t){var n=new Set;Object(O["a"])(this,G,se).call(this,n,{x:e[0],z:e[1],y:-1/0},{x:t[0],z:t[1],y:1/0},{a:{x:-1/0,y:-1/0,z:-1/0},b:{x:1/0,y:1/0,z:1/0}},this.root);var a=new Set;return Object(O["a"])(this,G,se).call(this,a,{x:e[0],z:t[1],y:-1/0},{x:t[0],z:1/0,y:1/0},{a:{x:-1/0,y:-1/0,z:-1/0},b:{x:1/0,y:1/0,z:1/0}},this.root),Object(O["a"])(this,G,se).call(this,a,{x:e[0],z:-1/0,y:-1/0},{x:t[0],z:e[1],y:1/0},{a:{x:-1/0,y:-1/0,z:-1/0},b:{x:1/0,y:1/0,z:1/0}},this.root),Object(s["a"])(n).filter((function(e){return!a.has(e)}))}}]),e}(),te=function e(t,n,a,r){if(r&&!(a<=0)){if(r.segs)return Object(O["a"])(this,X,ne).call(this,t,n,a,r);var i=n[ke(r.dim)];i<r.pos?(Object(O["a"])(this,Q,e).call(this,t,n,a,r.left),(t.top().value>r.pos-i||t.size()<a)&&Object(O["a"])(this,Q,e).call(this,t,n,a,r.right)):(Object(O["a"])(this,Q,e).call(this,t,n,a,r.right),(t.top().value>i-r.pos||t.size()<a)&&Object(O["a"])(this,Q,e).call(this,t,n,a,r.left))}},ne=function(e,t,n,a){var r,i=Object(c["a"])(a.segs);try{for(i.s();!(r=i.n()).done;){var s=r.value,o=this.segs[s],l=fe(t,o[0]),u=fe(o[1],o[0]);l.z=0,u.z=0;var h=Math.sqrt(xe(u,u));u=ve(u,h);var d=xe(l,u),f=o[3],p=void 0,v=void 0;d<=0?(p=he(o[0],t),v=o[0]):d>=h?(p=he(o[1],t),v=o[1]):(p=Math.sqrt(xe(l,l)-d*d),v=de(o[0],pe(u,d)));var y={id:f,value:p,point:v};Object(O["a"])(this,V,ae).call(this,e,n,y)}}catch(m){i.e(m)}finally{i.f()}},ae=function(e,t,n){void 0===$[n.id]?(e.size()<t?e.push(n):e.pushpop(n),$[n.id]=n):n.value<$[n.id].value&&($[n.id].value=n.value,$[n.id].point=n.point,e.updateItem(n))},re=function e(t,n,a,r){if(r&&!(a<=0)){if(r.segs)return Object(O["a"])(this,K,ie).call(this,t,n,a,r);var i=n[ke(r.dim)];i<r.pos?(Object(O["a"])(this,U,e).call(this,t,n,a,r.left),a>r.pos-i&&Object(O["a"])(this,U,e).call(this,t,n,a,r.right)):(Object(O["a"])(this,U,e).call(this,t,n,a,r.right),a>i-r.pos&&Object(O["a"])(this,U,e).call(this,t,n,a,r.left))}},ie=function(e,t,n,a){var r,i=Object(c["a"])(a.segs);try{for(i.s();!(r=i.n()).done;){var s=r.value,o=this.segs[s],l=fe(t,o[0]),u=fe(o[1],o[0]);l.z=0,u.z=0;var h=Math.sqrt(xe(u,u));u=ve(u,h);var d=xe(l,u),f=o[3],p=void 0,v=void 0;d<=0?(p=he(o[0],t),v=o[0]):d>=h?(p=he(o[1],t),v=o[1]):(p=Math.sqrt(xe(l,l)-d*d),v=de(o[0],pe(u,d))),p<n&&(void 0===e[f]?e[f]={id:f,value:p,point:v}:e[f].value>p&&(e[f].value=p,e[f].point=v))}}catch(y){i.e(y)}finally{i.f()}},se=function e(t,n,a,r,i){if(!(n.x>=a.x||n.y>=a.y||n.z>=a.z)&&i){if(i.segs)return Object(O["a"])(this,Z,le).call(this,t,n,a,i);if(r.a.x>=n.x&&r.a.y>=n.y&&r.a.z>=n.z&&r.b.x<=a.x&&r.b.y<=a.y&&r.b.z<=a.z)return Object(O["a"])(this,J,oe).call(this,t,n,a,i);var s=n[ke(i.dim)],l=a[ke(i.dim)],c=!1,h=!1;s>=i.pos&&(c=!0),l<=i.pos&&(h=!0),c||Object(O["a"])(this,G,e).call(this,t,n,a,{a:r.a,b:Object(o["a"])(Object(o["a"])({},r.b),{},Object(u["a"])({},ke(i.dim),i.pos))},i.left),h||Object(O["a"])(this,G,e).call(this,t,n,a,{a:Object(o["a"])(Object(o["a"])({},r.a),{},Object(u["a"])({},ke(i.dim),i.pos)),b:r.b},i.right)}},oe=function e(t,n,a,r){if(r){if(r.segs)return Object(O["a"])(this,Z,le).call(this,t,n,a,r);Object(O["a"])(this,J,e).call(this,t,n,a,r.left),Object(O["a"])(this,J,e).call(this,t,n,a,r.right)}},le=function(e,t,n,a){var r,i=Object(c["a"])(a.segs);try{for(i.s();!(r=i.n()).done;){var s=r.value,o=this.segs[s],l=o[3];e.has(l)||(isFinite(t.z)||isFinite(n.z)?o[2]>=t.z&&o[2]<=n.z&&o[0].x<n.x&&o[1].x>t.x&&e.add(l):(o[0].x>=t.x&&o[0].y>=t.y&&o[0].x<=n.x&&o[0].y<=n.y||o[1].x>=t.x&&o[1].y>=t.y&&o[1].x<=n.x&&o[1].y<=n.y||E({x1:o[0].x,y1:o[0].y,x2:o[1].x,y2:o[1].y},{x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}))&&e.add(l))}}catch(u){i.e(u)}finally{i.f()}};function ce(e,t,n){var a=ue(e,t),r=ue(n,t),i=ue(e,n),s=(a*a+r*r-i*i)/2/a/r,o=Math.sqrt(1-be(s)),l=2*o/i;return l}function ue(e,t){var n,a;return Math.sqrt(be(e.x-t.x)+be(e.y-t.y)+be((null!==(n=e.z)&&void 0!==n?n:0)-(null!==(a=t.z)&&void 0!==a?a:0)))}function he(e,t){return Math.sqrt(be(e.x-t.x)+be(e.y-t.y))}function de(e,t){var n,a;return{x:e.x+t.x,y:e.y+t.y,z:(null!==(n=e.z)&&void 0!==n?n:0)+(null!==(a=t.z)&&void 0!==a?a:0)}}function fe(e,t){var n,a;return{x:e.x-t.x,y:e.y-t.y,z:(null!==(n=e.z)&&void 0!==n?n:0)-(null!==(a=t.z)&&void 0!==a?a:0)}}function pe(e,t){var n;return{x:e.x*t,y:e.y*t,z:(null!==(n=e.z)&&void 0!==n?n:0)*t}}function ve(e,t){var n;return{x:e.x/t,y:e.y/t,z:(null!==(n=e.z)&&void 0!==n?n:0)/t}}function ye(e,t){var n,a;return{x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),z:Math.min(null!==(n=e.z)&&void 0!==n?n:0,null!==(a=t.z)&&void 0!==a?a:0)}}function me(e,t){var n,a;return{x:Math.max(e.x,t.x),y:Math.max(e.y,t.y),z:Math.max(null!==(n=e.z)&&void 0!==n?n:0,null!==(a=t.z)&&void 0!==a?a:0)}}function xe(e,t){var n,a;return e.x*t.x+e.y*t.y+(null!==(n=e.z)&&void 0!==n?n:0)*(null!==(a=t.z)&&void 0!==a?a:0)}function ge(e){var t,n,a=Math.sqrt(be(e.x)+be(e.y)+be(null!==(t=e.z)&&void 0!==t?t:0));return{x:e.x/a,y:e.y/a,z:(null!==(n=e.z)&&void 0!==n?n:0)/a}}function be(e){return e*e}function we(e,t,n,a,r){if(!(t<e))if(t-e<=1)Me(e,t,a,r);else{for(var i=r.pos[e],s=r.pos[t],o=ge(fe(s,i)),l=0,c=e,u=e;u<=t;u++){var h=r.pos[u],d=fe(h,i),f=xe(d,o),p=xe(d,d)-f*f;p>l&&(c=u,l=p)}l<n||c===e||c===t?Me(e,t,a,r):(we(e,c,n,a,r),we(c,t,n,a,r))}}function Me(e,t,n,a){a.lineID.push(n),a.segIndex.push([e,t])}function Ce(e){var t,n=0,a=Object(c["a"])(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n+=r.sp.length+1}}catch(i){a.e(i)}finally{a.f()}return n}function je(e,t){return e.sort((function(e,t){return e[0]<t[0]})),e[Math.floor(e.length/2)][0]}function ke(e){return 0==e?"x":1==e?"y":"z"}function Se(e,t){var n,a,r=e.from,i=e.to;e.aabb={a:{x:t[r].x,y:t[r].y,z:null!==(n=t[r].z)&&void 0!==n?n:0},b:{x:t[r].x,y:t[r].y,z:null!==(a=t[r].z)&&void 0!==a?a:0}};for(var s=r+1;s<=i;s++){var o,l;e.aabb={a:{x:Math.min(e.aabb.a.x,t[s].x),y:Math.min(e.aabb.a.y,t[s].y),z:Math.min(e.aabb.a.z,null!==(o=t[s].z)&&void 0!==o?o:0)},b:{x:Math.max(e.aabb.b.x,t[s].x),y:Math.max(e.aabb.b.y,t[s].y),z:Math.max(e.aabb.b.z,null!==(l=t[s].z)&&void 0!==l?l:0)}}}}function Oe(e,t,n,a,r,i){var s,o=Object(c["a"])(n);try{for(o.s();!(s=o.n()).done;){var l=s.value,u=l.aabb.a[ke(e)],h=l.aabb.b[ke(e)];if(u>h){var d=u;u=h,h=d}if(t<=u)r.push(l);else if(t>=h)a.push(l);else{var f=0,p={sp:[]},v=p,y=i.pos[l.from][ke(e)]<t;p.from=l.from;for(var m=l.from+1;m<=l.to;m++){var x=i.pos[m][ke(e)],g=!1;if(x<t?y||(p.to=m,r.push(p),v=p,De(v,i),Se(v,i.pos),p={sp:[]},p.from=m-1,y=!0,g=!0):y&&(p.to=m,a.push(p),v=p,De(v,i),Se(v,i.pos),p={sp:[]},p.from=m-1,y=!1,g=!0),l.sp.length>f&&(l.sp[f]<m&&++f,l.sp[f]==m))if(g){var b=v.sp;b.push(m)}else{p.sp;p.sp.push(m)}}p.to=l.to,y?(a.push(p),Se(p,i.pos)):(r.push(p),Se(p,i.pos))}}}catch(w){o.e(w)}finally{o.f()}}function De(e,t){if(e.sp&&0!=e.sp.length)if(1==e.sp.length)Le(e.from,e.sp[0],e.to,t)&&(e.sp=[]);else if(e.sp.length>1){var n=!1,a=!1;Le(e.from,e.sp[0],e.sp[1],t)&&(n=!0),Le(e.sp[e.sp.length-2],e.sp[e.sp.length-1],e.to,t)&&(a=!0),n&&e.sp.shift(),a&&e.sp.pop()}}function Le(e,t,n,a){var r=Math.cos(W.deg/180*Math.PI),i=a.pos[e],s=a.pos[t],o=a.pos[n],l=ge(fe(s,i)),c=ge(fe(o,s)),u=xe(l,c);return isNaN(u)||u>=r}function _e(e,t,n,a,r,i,s){var o,l=n/(e+1e-10);if(l<=1)return 1/0;o=Math.log(n)/Math.log(l);var c,u=n/(t+1e-10);if(u<=1)return 1/0;if(0==a||1==a)return 1/0;c=Math.log(n)/Math.log(u);var h=a*e+(1-a)*t,d=.5*(o+c);return h+d*W.b}function Ie(e,t,n){n?e.left=t:e.right=t}var ze=n("6125"),Ae=n.n(ze),Be=n("c1df"),Ee=n.n(Be),Te=(new Float32Array(5e5),{}),Re={props:{timeIndex:Number,valueIndex:Number,timeName:String,valueName:String,filter:Float32Array},components:{draggable:v.a},data:function(){return{canvas:null,contextHandler:null,canvasContext:null,rawLineContext:null,filterMode:"brush",brushMethod:"tree",rawMode:"rep",repCount:3,diverse:.1,cursor:"crosshair",mouseDown:!1,listener:null,hoverListener:null,hoveringInd:null,coord:[0,0,0,0,0],boxes:[],maxDensity:null,maxOverlayDensity:null,rawLines:[],colorMap:["aqua","limegreen","lightgreen"],upsideDown:!1,showCursorValue:!0,normalizeDensity:!0,enlargeFont:!1,headers:[],previewIndex:-1,selectedQuery:"$int",tableColumns:[{type:"expand",width:50,render:function(e,t){return e(j,{props:{row:t.row.reps}})}},{title:"Query",align:"center",slot:"name"},{title:"Line series count",align:"center",key:"count"},{title:"Time points count",align:"center",key:"points"},{title:"Min value",align:"center",key:"minV"},{title:"Max value",align:"center",key:"maxV"},{title:"Mean value",align:"center",key:"mean"},{title:"Variance",align:"center",key:"var"},{title:"Operations",align:"center",slot:"op",width:250}],repColumns:[{title:"Index num.",align:"center",key:"name"},{title:"Min start time",align:"center",key:"minT"},{title:"Max start time",align:"center",key:"maxT"},{title:"Min value",align:"center",key:"minV"},{title:"Max value",align:"center",key:"maxV"},{title:"Mean value",align:"center",key:"mean"}],layers:[{id:"rep_layer",name:"representative line",opacity:1},{id:"selectionCanvas",name:"selected density",opacity:0},{id:"selectionLayer",name:"selected line",opacity:.4},{id:"canvas",name:"density",opacity:1},{id:"raw_lines",name:"raw line",opacity:0}],colormapIndexCache:1,colormapOverlayIndexCache:1,initDensityCache:null,initDensityBufferCache:null,initDensityMaxCache:0,currentDensityMax:0,currentDensity:null,distanceCache:{},colorCache:{},querys:[],preview:null,modify:null,mark:!1,selectionLayerContext:null,repLayerContext:null,rawLinesLayerContext:null,mouseLayerContext:null,queryResult:[],xScale:null,yScaleC:null,yScale:null,cursorHelper:null,svg:null,tr:null,cnt:0,renderSelectedDensity:0,repModal:!1,repStaticInformation:[],attributeColumn:null,attributeValue:null,attributeData:[]}},computed:{rawLineNames:function(){return Object(s["a"])(this.rawLines).map((function(e){return y.aggregatedData[e].key}))},upsideDownFactor:function(){return this.upsideDown?-1:1},previewData:function(){var e=this;return this.previewIndex<0?[]:Object(s["a"])(y.aggregatedData[this.previewIndex].ref).slice(0,6).map((function(t,n){return 5==n?e.headers.map((function(e){return"..."})):y.data[t]}))},tableData:function(){var e=this;if(!this.cnt)return[];for(var t=[],n={brush:"Brush",ang:"Angle",knn:"KNN",rnn:"Radius",attr:"Attribute"},a=0;a<y.querys.length;a++)y.querys[a].reps||(y.querys[a].reps=this.calcRepLines(Object(s["a"])(y.querys[a].cache))),t.push(Object(o["a"])(Object(o["a"])({_expanded:a==this.selectedQuery,query:a,name:n[y.querys[a].type]},this.getStaticInformation(Object(s["a"])(y.querys[a].cache))),{},{reps:y.querys[a].reps.map((function(t){return Object(o["a"])({name:y.aggregatedData[t].key,color:"rgb(".concat(e.getColor(t).join(","),")")},e.getStaticInformation([t]))}))}));return console.log("this is unoberserve interResult"),console.log(y.interResult),y.interReps=this.calcRepLines(y.interResult),t.push(Object(o["a"])(Object(o["a"])({_expanded:"$int"==this.selectedQuery,query:"$int",name:y.querys.length?"intersection":"global"},this.getStaticInformation(y.querys.length?y.interResult:new Array(y.aggregatedData.length).fill().map((function(e,t){return t})))),{},{reps:(y.querys.length?y.interReps:y.globalRep).map((function(t){return Object(o["a"])({name:y.aggregatedData[t].key,color:"rgb(".concat(e.getColor(t).join(","),")")},e.getStaticInformation([t]))}))})),y.querys.length&&(y.unionReps=this.calcRepLines(y.unionResult),t.push(Object(o["a"])(Object(o["a"])({_expanded:"$uni"==this.selectedQuery,query:"$uni",name:"union"},this.getStaticInformation(y.unionResult)),{},{reps:y.unionReps.map((function(t){return Object(o["a"])({name:y.aggregatedData[t].key,color:"rgb(".concat(e.getColor(t).join(","),")")},e.getStaticInformation([t]))}))}))),console.log(t),t}},watch:{enlargeFont:function(e){e?(this.svg.select("#xaxis").attr("font-size","14px"),this.svg.select("#yaxis").attr("font-size","14px")):(this.svg.select("#xaxis").attr("font-size","10px"),this.svg.select("#yaxis").attr("font-size","10px"))},colormapIndexCache:function(e){console.log(e),this.renderColorMap(),this.renderAllDensity()},colormapOverlayIndexCache:function(){this.renderColorMapOverlay(),this.renderDensity()},repCount:function(e){this.renderBoxes()},layers:{deep:!0,handler:function(e){for(var t in y.layers=e,this.rearrangeLayer(e),e){var n=e[t];"selectionCanvas"===n.id&&(!this.renderSelectedDensity&&n.opacity>0&&this.renderDensity(),this.renderSelectedDensity=n.opacity>0)}}},showCursorValue:function(){this.svg.select("#cursorHelper").selectAll("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",0),this.svg.select("#cursorHelper").selectAll("text").attr("x",0).attr("y",0).text("")},upsideDown:function(e){y.upsideDown=e,this.svg.select("#cursorHelper").selectAll("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",0),this.svg.select("#cursorHelper").selectAll("text").attr("x",0).attr("y",0).text(""),this.setReverseY(e)},filter:function(e){this.contextHandler.rerender(e),this.getTopK()},contextHandler:function(){this.filter&&this.contextHandler.rerender(this.filter)},filterMode:function(){},rawMode:function(){this.getTopK()},maxDensity:function(){this.renderAllDensity()},maxOverlayDensity:function(){this.renderDensity()},diverse:function(){var e=this;clearTimeout(y.diverseChange),y.diverseChange=setTimeout((function(){e.renderBoxes()}),50)},selectedQuery:function(e,t){e!==t&&(this.renderBoxes(),this.renderDensity())},colorMap:function(){var e=this.rawLines;this.rawLineContext.clearRect(0,0,1e3,500);for(var t=this.colorMap,n=0;n<e.length;n++){var a=y.aggregatedData[e[n]];this.rawLineContext.globalAlpha=1,this.rawLineContext.strokeStyle=t[n%3],this.rawLineContext.lineWidth=2,this.rawLineContext.beginPath(),this.rawLineContext.moveTo(a[this.timeIndex][0]/this.contextHandler.maxX*1e3,500-a[this.valueIndex][0]/this.contextHandler.maxY*500);for(var r=0;r<a[this.timeIndex].length;r++)this.rawLineContext.lineTo(a[this.timeIndex][r]/this.contextHandler.maxX*1e3,500-a[this.valueIndex][r]/this.contextHandler.maxY*500);this.rawLineContext.stroke()}},normalizeDensity:function(){this.renderAllDensity(!0),this.renderDensity()}},methods:{leaveQuery:function(e){this.mark=!1,this.renderBoxes("mouseLayer")},handleSearch:function(e){if(console.log(e),void 0!==this.attributeColumn&&e.length){var t=y.headers[this.attributeColumn],n=y.headerMap.get(t);console.log(y.headerMap),console.log(t,n,this.attributeValue),this.attributeData=n.filter((function(t){return t.slice(0,e.length)===e})).slice(0,10)}else this.attributeData=[]},hoveringQuery:function(e){console.log(e),e>=y.querys.length||this.hovering(e)},addAttrQuery:function(){y.querys.push({type:"attr",info:{ind:this.attributeColumn,val:this.attributeValue}}),this.renderBoxes(),this.cnt++},deleteAllQuery:function(){y.querys=[],this.renderBoxes(),this.cnt++},deleteQuery:function(e){var t=!1;this.selectedQuery===e&&(t=!0),y.querys.splice(e,1),t&&(this.selectedQuery="$int"),this.renderBoxes(),this.cnt++,this.renderDensity()},canvasMousedown:function(e){if(2!==e.button){var t=[e.offsetX,e.offsetY],n=this.findBox(t);if(n)return this.modify=n,this.preview=this.modify.instance,this.modify.lastPos=t,void(this.modify.onBorder?this.modify.type="resize":this.modify.type="drag");"attr"!==this.filterMode&&(this.preview={type:this.filterMode,start:t},y.preview=this.preview,"knn"===this.preview.type?this.preview.n=5:"rnn"===this.preview.type?this.preview.n=10:"ang"===this.preview.type&&(this.preview.n=5))}},canvasMouseup:function(e){if(2!==e.button&&this.preview){if(this.modify)y.querys[this.modify.i]=this.preview,this.modify=this.preview=null;else{if("attr"===this.filterMode)return;var t=[e.offsetX,e.offsetY];"knn"===this.preview.type||"rnn"===this.preview.type?this.preview.start=t:"brush"!==this.preview.type&&"ang"!==this.preview.type||(this.preview.end=t),this.preview.cache=null,this.preview.reps=null,y.querys.push(this.preview),this.preview=null}y.preview=this.preview,console.time("renderBoxes in mouseup"),this.renderBoxes(),console.timeEnd("renderBoxes in mouseup"),console.time("render Density in mouseup"),this.renderDensity(),console.timeEnd("render Density in mouseup"),this.cnt++}},canvasWheel:function(e){var t=this,n=[e.offsetX,e.offsetY],a=this.findBox(n);if(a){e.preventDefault();var r=a.instance,i=Math.sign(e.deltaY);"knn"!==r.type&&"rnn"!==r.type&&"ang"!==r.type||("ang"===r.type?r.n=Math.min(Math.max(1,r.n-i),180):r.n=Math.max(r.n-Math.sign(e.deltaY),0),r.cache=null,r.reps=null,console.log(r.n)),clearTimeout(y.async),y.async=setTimeout((function(){t.renderBoxes()}),10),this.cnt++}},canvasMousemove:function(e){var t=this,n=[e.offsetX,e.offsetY];if(this.renderAxisHelper(e),this.preview){if(this.modify){if("resize"===this.modify.type)"brush"===this.preview.type?(A(this.preview.end,this.modify.lastPos,n),A(this.preview.start,this.modify.lastPos,n)):"ang"===this.preview.type&&(this.preview.end[0]=n[0],this.preview.end[1]+=n[1]-this.modify.lastPos[1]);else{var a=n[0]-this.modify.lastPos[0],r=n[1]-this.modify.lastPos[1];"brush"!==this.preview.type&&"ang"!==this.preview.type||B(this.preview.end,a,r),B(this.preview.start,a,r)}this.modify.lastPos=n}else"knn"===this.preview.type||"rnn"===this.preview.type?this.preview.start=n:"brush"!==this.preview.type&&"ang"!==this.preview.type||(this.preview.end=n);this.preview.cache=null,console.time("renderBoxes"),clearTimeout(y.async),y.async=setTimeout((function(){t.renderBoxes()}),10),this.renderBoxes(),console.timeEnd("renderBoxes")}else this.findBox(n)},mouseContextmenu:function(e){e.preventDefault()},hoverLines:function(e){var t=this,n=e.offsetX,a=e.offsetY,r=this.contextHandler.filterRange((n-5)/1e3,(n+5)/1e3,1-(a+5)/500,1-(a-5)/500).filter((function(e){return!t.filter||t.filter.includes(e)})).slice(0,3);this.rawLineContext.clearRect(0,0,1e3,500);for(var i=this.colorMap,s=r.length-1;s>=0;s--){var o=y.aggregatedData[r[s]];this.rawLineContext.globalAlpha=1,this.rawLineContext.strokeStyle=i[s%3],this.rawLineContext.lineWidth=2,this.rawLineContext.beginPath(),this.rawLineContext.moveTo(o[this.timeIndex][0]/this.contextHandler.maxX*1e3,500-o[this.valueIndex][0]/this.contextHandler.maxY*500);for(var l=0;l<o[this.timeIndex].length;l++)this.rawLineContext.lineTo(o[this.timeIndex][l]/this.contextHandler.maxX*1e3,500-o[this.valueIndex][l]/this.contextHandler.maxY*500);this.rawLineContext.stroke()}this.rawLines=r},getTopK:function(){var e=[];switch(this.hoverListener&&this.$refs.canvas.removeEventListener("mousemove",this.hoverListener),this.rawMode){case"cur":this.hoverListener=this.hoverLines.bind(this),this.$refs.canvas.addEventListener("mousemove",this.hoverListener);break;case"out":e=this.contextHandler.findKTop(!1);break;case"rep":e=this.contextHandler.findKTop(!0,this.diverse);break}this.rawLineContext.clearRect(0,0,1e3,500);for(var t=this.colorMap,n=e.length-1;n>=0;n--){var a=y.aggregatedData[e[n]];this.rawLineContext.globalAlpha=1,this.rawLineContext.strokeStyle=t[n%3],this.rawLineContext.lineWidth=2,this.rawLineContext.beginPath(),this.rawLineContext.moveTo(a[this.timeIndex][0]/this.contextHandler.maxX*1e3,500-a[this.valueIndex][0]/this.contextHandler.maxY*500);for(var r=0;r<a[this.timeIndex].length;r++)this.rawLineContext.lineTo(a[this.timeIndex][r]/this.contextHandler.maxX*1e3,500-a[this.valueIndex][r]/this.contextHandler.maxY*500);this.rawLineContext.stroke()}this.rawLines=e},resetFilter:function(){this.$emit("filterChange",void 0),this.boxes=[],this.mouseDown=!1,this.canvasContext.clearRect(0,0,1e3,500),this.coord=[0,0,0,0,0]},startMouse:function(e){var t=this;if(!this.mouseDown){this.mouseDown=!0;var n=e.offsetX,a=e.offsetY,r=!1;if("rect"==this.filterMode){n/=1e3,a=1-a/500;var i,o=Object(c["a"])(this.boxes);try{for(o.s();!(i=o.n()).done;){var l=i.value;if((Math.abs(n-l[0])<=.002||Math.abs(n-l[1])<=.002)&&a>l[2]&&a<l[3]?(Math.abs(n-l[0])<=.002?this.mouseDown="left":this.mouseDown="right",r=!0):(Math.abs(a-l[2])<=.004||Math.abs(a-l[3])<=.004)&&n>l[0]&&n<l[1]?(Math.abs(a-l[2])<=.004?this.mouseDown="bottom":this.mouseDown="top",r=!0):n>l[0]&&n<l[1]&&a>l[2]&&a<l[3]&&(this.mouseDown="move",r=!0),r){var u=function(){t.coord=[1e3*l[0],500-500*l[3],1e3*l[1],500-500*l[2],0],t.boxes.splice(t.boxes.indexOf(l),1);var e=void 0;return t.boxes.forEach((function(n){var a,r=(a=t.contextHandler).filterRange.apply(a,Object(s["a"])(n));e=e?e.filter((function(e){return r.includes(e)})):r})),t.$emit("filterChange",e),"break"}();if("break"===u)break}}}catch(h){o.e(h)}finally{o.f()}}else Math.abs(n-this.coord[0])<=2&&Math.abs(a-this.coord[1])<=2?(this.mouseDown="move",r=!0):Math.abs(n-this.coord[2])<=2&&Math.abs(a-this.coord[3])<=Math.abs(this.coord[4]-this.coord[3])?(this.mouseDown="time",r=!0):n>this.coord[0]&&n<this.coord[2]&&a>this.coord[1]*(this.coord[2]-n)/(this.coord[2]-this.coord[0])+(this.coord[3]-Math.abs(this.coord[4]-this.coord[3]))*(n-this.coord[0])/(this.coord[2]-this.coord[0])&&a<this.coord[1]*(this.coord[2]-n)/(this.coord[2]-this.coord[0])+(this.coord[3]+Math.abs(this.coord[4]-this.coord[3]))*(n-this.coord[0])/(this.coord[2]-this.coord[0])&&(this.mouseDown="angular",r=!0);r||(this.coord=[0,0,0,0,0],this.coord[0]=e.offsetX,this.coord[1]=e.offsetY),this.listener=this.startFilter.bind(this),window.addEventListener("mouseup",this.listener)}},drawBoxes:function(){var e,t=Object(c["a"])(this.boxes);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.canvasContext.fillRect(1e3*n[0],500-500*n[3],1e3*(n[1]-n[0]),500*(n[3]-n[2]))}}catch(a){t.e(a)}finally{t.f()}},cursorShape:function(e){var t=e.offsetX,n=e.offsetY;switch(this.mouseDown){case"move":return void(this.cursor="grabbing");case"left":case"right":case"time":return void(this.cursor="ew-resize");case"top":case"bottom":case"angular":case"range":return void(this.cursor="ns-resize");case"magnet":case!0:return void(this.cursor="crosshair");default:if("rect"==this.filterMode){t/=1e3,n=1-n/500;var a,r=Object(c["a"])(this.boxes);try{for(r.s();!(a=r.n()).done;){var i=a.value;if((Math.abs(t-i[0])<=.002||Math.abs(t-i[1])<=.002)&&n>i[2]&&n<i[3])return void(this.cursor="ew-resize");if((Math.abs(n-i[2])<=.004||Math.abs(n-i[3])<=.004)&&t>i[0]&&t<i[1])return void(this.cursor="ns-resize");if(t>i[0]&&t<i[1]&&n>i[2]&&n<i[3])return void(this.cursor="move")}}catch(s){r.e(s)}finally{r.f()}}else{if(Math.abs(t-this.coord[0])<=2&&Math.abs(n-this.coord[1])<=2)return void(this.cursor="move");if(Math.abs(t-this.coord[2])<=2&&Math.abs(n-this.coord[3])<=Math.abs(this.coord[4]-this.coord[3]))return void(this.cursor="ew-resize");if(t>this.coord[0]&&t<this.coord[2]&&n>this.coord[1]*(this.coord[2]-t)/(this.coord[2]-this.coord[0])+(this.coord[3]-Math.abs(this.coord[4]-this.coord[3]))*(t-this.coord[0])/(this.coord[2]-this.coord[0])&&n<this.coord[1]*(this.coord[2]-t)/(this.coord[2]-this.coord[0])+(this.coord[3]+Math.abs(this.coord[4]-this.coord[3]))*(t-this.coord[0])/(this.coord[2]-this.coord[0]))return void(this.cursor="ns-resize")}this.cursor="crosshair"}},moveMouse:function(e){if(this.cursorShape(e),this.mouseDown)if("magnet"==this.mouseDown?this.coord[4]=e.offsetY:"move"==this.mouseDown?(this.coord[0]+=e.movementX,this.coord[2]+=e.movementX,this.coord[1]+=e.movementY*this.upsideDownFactor,this.coord[3]+=e.movementY*this.upsideDownFactor,this.coord[4]+=e.movementY*this.upsideDownFactor):"left"==this.mouseDown?this.coord[0]=e.offsetX:"right"==this.mouseDown?this.coord[2]=e.offsetX:"bottom"==this.mouseDown?this.coord[3]=e.offsetY:"top"==this.mouseDown?this.coord[1]=e.offsetY:"time"==this.mouseDown?this.coord[2]=Math.max(this.coord[0]+1,e.offsetX):"angular"==this.mouseDown?(this.coord[3]+=e.movementY*this.upsideDownFactor,this.coord[4]+=e.movementY*this.upsideDownFactor):(this.coord[2]=e.offsetX,this.coord[3]=e.offsetY),this.canvasContext.clearRect(0,0,1e3,500),"rect"==this.filterMode)this.canvasContext.globalAlpha=.3,this.canvasContext.fillStyle="black",this.drawBoxes(),this.canvasContext.fillRect(Math.min(this.coord[0],this.coord[2]),Math.min(this.coord[1],this.coord[3]),Math.abs(this.coord[2]-this.coord[0]),Math.abs(this.coord[3]-this.coord[1]));else if(this.canvasContext.globalAlpha=1,this.canvasContext.strokeStyle="black",this.canvasContext.beginPath(),this.canvasContext.moveTo(this.coord[0],this.coord[1]),this.canvasContext.lineTo(this.coord[2],this.coord[3]),this.canvasContext.stroke(),this.mouseDown&&!0!==this.mouseDown){var t=this.coord[4]-this.coord[3];this.canvasContext.beginPath(),this.canvasContext.moveTo(this.coord[2],this.coord[3]-t),this.canvasContext.lineTo(this.coord[2],this.coord[3]+t),this.canvasContext.stroke(),this.canvasContext.globalAlpha=.3,this.canvasContext.fillStyle="black",this.canvasContext.beginPath(),this.canvasContext.moveTo(this.coord[0],this.coord[1]),this.canvasContext.lineTo(this.coord[2],this.coord[3]-t),this.canvasContext.lineTo(this.coord[2],this.coord[3]+t),this.canvasContext.fill()}},startFilter:function(){if("rect"==this.filterMode&&(this.mouseDown=!1,0!=this.coord[2]||0!=this.coord[3])){var e=[this.coord[0],this.coord[2]].map((function(e){return e/1e3})).sort(),t=Object(l["a"])(e,2),n=t[0],a=t[1],r=[this.coord[1],this.coord[3]].map((function(e){return 1-e/500})).sort(),i=Object(l["a"])(r,2),s=i[0],o=i[1];this.boxes.push([n,a,s,o]);var c=this.contextHandler.filterRange(n,a,s,o);this.filter?this.$emit("filterChange",this.filter.filter((function(e){return c.includes(e)}))):this.$emit("filterChange",c)}window.removeEventListener("mouseup",this.listener),this.listener=null},angleConfirm:function(){if("ang"==this.filterMode&&this.coord[2]&&this.coord[3]&&this.coord[0]!=this.coord[2])if(!0===this.mouseDown){this.mouseDown="magnet";var e=[0,0],t=[0,0];this.coord[0]<this.coord[2]?(e=this.coord.slice(0,2),t=this.coord.slice(2,4)):(t=this.coord.slice(0,2),e=this.coord.slice(2,4)),this.coord=[].concat(Object(s["a"])(e),Object(s["a"])(t),[0])}else if(this.mouseDown){this.mouseDown=!1;var n=Math.abs(this.coord[4]-this.coord[3]),a=-(this.coord[3]+n-this.coord[1])/(this.coord[2]-this.coord[0]),r=-(this.coord[3]-n-this.coord[1])/(this.coord[2]-this.coord[0]);this.$emit("filterChange",this.contextHandler.filterAngle(this.coord[0]/1e3,this.coord[2]/1e3,a,r))}},exportFig:function(){h(this.layers.map((function(e){return document.getElementById(e.id)})).reverse(),this.upsideDown,this.layers.map((function(e){return e.opacity})).reverse())},showRepData:function(){var e=this;this.repModal=!0,this.repStaticInformation=y.repIds.map((function(t){return Object(o["a"])({name:t},e.getStaticInformation([t]))}))},hightlightRow:function(e){return e.query===this.selectedQuery?"selected-table-row":""},calClassName:function(e){var t=this.hightlightRow(e)+" "+(e.query===this.hoveringInd?"ivu-table-row-hover":"");return t},calcLineDistance:function(e,t){if(e==t)return 0;if(e>t){var n=[t,e];e=n[0],t=n[1]}if(this.distanceCache[e]||(this.distanceCache[e]={}),void 0!==this.distanceCache[e][t])return this.distanceCache[e][t];var a=0,r=0,i=0,s=0,o=y.result[e],l=y.result[t];while(1){while(i<o.length&&s<l.length&&o[i].x<l[s].x)i++;while(i<o.length&&s<l.length&&o[i].x>l[s].x)s++;if(i>=o.length||s>=l.length)break;o[i].x==l[s].x&&(r++,a+=Math.abs(o[i].y-l[s].y),i++,s++)}return a/=r,r||(a=1/0),this.distanceCache[e][t]=a,a},drawRawLines:function(){var e=y.result.slice().map((function(e,t){return{line:e,id:t}}));for(var t in e.sort((function(){return Math.random()>.5?1:-1})),e){var n=e[t],a=n.line,r=n.id;y.rawLinesLayerContext.strokeStyle="rgb(".concat(this.getColor(r).join(","),")"),y.rawLinesLayerContext.beginPath(),y.rawLinesLayerContext.moveTo(a[0].x,a[0].y);var i,s=Object(c["a"])(a);try{for(s.s();!(i=s.n()).done;){var o=i.value;y.rawLinesLayerContext.lineTo(o.x,o.y)}}catch(l){s.e(l)}finally{s.f()}y.rawLinesLayerContext.stroke()}},renderQuerys:function(){var e=document.getElementById("query_ctner");e.innerHTML="",y.querys.length||(e.innerHTML="(empty)");for(var t=function(t){var n=y.querys[t],a=document.createElement("p"),r=document.createElement("i");r.style.display="inline-block",r.style.background="knn"===n.type?"deepskyblue":"ang"===n.type?"transparent":"gray",r.style.borderRadius="knn"===n.type||"rnn"===n.type?"50%":"0",r.style.borderBottom=r.style.borderRight="ang"===n.type?"6px solid gray":"",r.style.borderLeft=r.style.borderTop="ang"===n.type?"6px solid transparent":"",r.style.height=r.style.width="ang"===n.type?"0":"12px";var i=document.createElement("span");switch(n.type){case"knn":i.innerText="KNN";break;case"rnn":i.innerText="RNN";break;case"brush":i.innerText="Brush";break;case"ang":i.innerText="Angular";break}var s=document.createElement("p");switch(n.type){case"knn":s.innerText="k=";break;case"rnn":s.innerText="r=";break;case"brush":s.innerHTML="(".concat(n.start.map((function(e,t){return 0===t?"date"==y.inferX?Ee()(xScale.invert(e)).format("YYYY-M-D"):xScale.invert(e).toFixed(0):yScale.invert(500-e).toFixed(0)})).join(", "),") ~<br>(").concat(n.end.map((function(e,t){return 0===t?"date"==y.inferX?Ee()(xScale.invert(e)).format("YYYY-M-D"):xScale.invert(e).toFixed(0):yScale.invert(500-e).toFixed(0)})).join(", "),")");break;case"ang":s.innerText="degree";break}var o=document.createElement("input");o.type="number",o.value=n.n,o.addEventListener("change",(function(){n.n=parseFloat(o.value),n.cache=null,n.reps=null,setTimeout(renderBoxes,0)})),"knn"!==n.type&&"rnn"!==n.type&&"ang"!==n.type||s.append(o);var l=document.createElement("button");l.innerText="Delete this query",l.addEventListener("click",(function(){querys.splice(t,1),setTimeout(renderBoxes,0),setTimeout(renderDensity,0)})),a.append(r,i,s,l),a.addEventListener("mouseenter",(function(){a.style.border="1px solid red",hoverBox(n)})),a.addEventListener("mouseleave",(function(){a.style.border="1px solid transparent",renderBoxes()})),e.appendChild(a)},n=0;n<y.querys.length;n++)t(n)},colorSpan:function(e){var t=this;return e.map((function(e){return'<span style="color: rgb('.concat(t.getColor(e).join(","),')">').concat(e,"</span>")}))},renderResult:function(e,t){y.interResult=e,y.unionResult=t},hovering:function(e,t){var n=y.querys[e];this.hoveringInd=e,this.mark!==n&&this.renderBoxes("mouseLayer"),this.mark=n,this.hoverBox(n),document.getElementById("canvas").style.cursor=t?"move":"pointer"},findBox:function(e){function t(e,t){var n=y.querys[e];this.hoveringInd=e,this.mark!==n&&this.renderBoxes("mouseLayer"),this.mark=n,this.hoverBox(n),document.getElementById("canvas").style.cursor=t?"move":"pointer"}for(var n=y.querys.length-1;n>=0;n--){var a=y.querys[n];if("brush"===a.type){var r=Math.min(a.start[0],a.end[0]),i=Math.max(a.start[0],a.end[0]),s=Math.min(a.start[1],a.end[1]),o=Math.max(a.start[1],a.end[1]),l=z(r,e[0])||z(i,e[0])||z(s,e[1])||z(o,e[1]);if(r<=e[0]&&e[0]<=i&&s<=e[1]&&e[1]<=o)return t.call(this,n,l),{instance:a,onBorder:l,i:n}}else if("knn"===a.type||"rnn"===a.type){var c=I(e,a.start);if(_(a.n)>c)return t.call(this,n),{instance:a,i:n}}else if("ang"===a.type){var u=Math.max(a.start[0]+1,a.end[0]),h=a.start,d=[u,a.end[1]],f=z(u,e[0]);if(h[0]<=e[0]&&e[0]<=u&&(h[0]===e[0]&&h[1]===e[1]||h[0]!==e[0]&&Math.abs(L(h,e)-L(h,d))<=a.n/180*Math.PI))return t.call(this,n,f),{instance:a,i:n,onBorder:f}}}this.mark&&(this.mark=!1,document.getElementById("canvas").style.cursor="default",this.renderBoxes("mouseLayer"),this.hoveringInd=null)},renderBox:function(e){var t;if("knn"===e.type){if(y.mouseLayerContext.beginPath(),(t=y.mouseLayerContext).arc.apply(t,Object(s["a"])(e.start).concat([6,0,2*Math.PI])),y.mouseLayerContext.fillStyle="deepskyblue",y.mouseLayerContext.fill(),!e.cache){var n=new Set,a=0;while(n.size<e.n)a+=e.n-n.size,n=new Set(this.tr.ee.knn(e.start,a).map((function(e){var t=e.id;return t})));e.cache=n}}else if("rnn"===e.type){var r;if(y.mouseLayerContext.beginPath(),(r=y.mouseLayerContext).arc.apply(r,Object(s["a"])(e.start).concat([e.n,0,2*Math.PI])),y.mouseLayerContext.fillStyle="rgba(0,0,0,0.3)",y.mouseLayerContext.fill(),!e.cache){var i=new Set(this.tr.ee.rnn(e.start,e.n).map((function(e){var t=e.id;return t})));e.cache=i}}else if("brush"===e.type){var o;if(y.mouseLayerContext.fillStyle="rgba(0,0,0,0.3)",(o=y.mouseLayerContext).fillRect.apply(o,Object(s["a"])(e.start.map((function(t,n){return Math.min(t,e.end[n])}))).concat(Object(s["a"])(e.end.map((function(t,n){return Math.abs(t-e.start[n])}))))),!e.cache){var l=Math.min(e.start[0],e.end[0]),c=Math.max(e.start[0],e.end[0]),u=Math.min(e.start[1],e.end[1]),h=Math.max(e.start[1],e.end[1]);if("seq"===this.brushMethod){var d=[];for(var f in y.result){var p=y.result[f],v=0,m=p.length-1,x=!0;if(!(p[m].x<l||p[v].x>c)){while(v<p.length-1&&p[v].x<l)v++;while(m>0&&p[m].x>c)m--;for(var g=v;x&&g<=m;g++)(p[g].y<u||p[g].y>h)&&(x=!1);if(0!==v){var b=D(p[v-1],p[v],l).y;(b<u||b>h)&&(x=!1)}if(m!==p.length-1){var w=D(p[m],p[m+1],c).y;(w<u||w>h)&&(x=!1)}x&&d.push(f)}}d=new Set(d),e.cache=d}else if("tree"===this.brushMethod){var M=new Set(this.tr.ee.brush([Math.min(e.start[0],e.end[0]),Math.min(e.start[1],e.end[1])],[Math.max(e.start[0],e.end[0]),Math.max(e.start[1],e.end[1])]).filter((function(e){var t,n,a=y.result[e],r=0,i=a.length-1,s=0,o=i;while(r<=i)t=r+i>>1,a[t].x>=l?(s=t,i=t-1):r=t+1;r=0,i=a.length-1;while(r<=i)t=r+i>>1,a[t].x<=c?(o=t,r=t+1):i=t-1;for(var d=s;d<=o;d++)if(a[d].y<u||a[d].y>h)return!1;return!(s&&(n=D(a[s-1],a[s],l).y,n<u||n>h))&&!(o<a.length-1&&(n=D(a[o],a[o+1],l).y,n<u||n>h))})));e.cache=M}else{var C=this.tr.ee.brush([Math.min(e.start[0],e.end[0]),Math.min(e.start[1],e.end[1])],[Math.max(e.start[0],e.end[0]),Math.max(e.start[1],e.end[1])]),j=new Set(C.filter((function(t){var n=t.raw;return E({x1:n[0],x2:n[1],y1:n[2],y2:n[3]},{x:Math.min(e.start[0],e.end[0]),y:Math.min(e.start[1],e.end[1]),width:Math.abs(e.start[0]-e.end[0]),height:Math.abs(e.start[1]-e.end[1])})})).map((function(e){var t=e.raw;return t[5]})));C.filter((function(t){var n=t.raw;return T({x:n[0],y:n[2]},{x:n[1],y:n[3]},{x:Math.min(e.start[0],e.end[0]),y:Math.min(e.start[1],e.end[1])-1},{x:Math.max(e.start[0],e.end[0]),y:Math.min(e.start[1],e.end[1])-1})||T({x:n[0],y:n[2]},{x:n[1],y:n[3]},{x:Math.min(e.start[0],e.end[0]),y:Math.max(e.start[1],e.end[1])+1},{x:Math.max(e.start[0],e.end[0]),y:Math.max(e.start[1],e.end[1])+1})})).forEach((function(e){var t=e.raw;return j.delete(t[5])})),e.cache=j}}}else if("ang"===e.type){var k=Math.max(e.start[0]+1,e.end[0]),S=e.start[0],O=k,L=(e.end[1]-e.start[1])/(k-e.start[0]),_=Math.atan(L),I=Math.min(.5*Math.PI-1e-4,_+e.n/180*Math.PI),z=Math.max(-.5*Math.PI+1e-4,_-e.n/180*Math.PI),A=Math.tan(I),B=Math.tan(z),R=e.start[1]+A*(k-e.start[0]),q=e.start[1]+B*(k-e.start[0]);if(y.mouseLayerContext.fillStyle="rgba(0,0,0,0.3)",y.mouseLayerContext.beginPath(),y.mouseLayerContext.moveTo(e.start[0],e.start[1]),y.mouseLayerContext.lineTo(k,q),y.mouseLayerContext.lineTo(k,R),y.mouseLayerContext.closePath(),y.mouseLayerContext.fill(),y.mouseLayerContext.lineWidth=1,y.mouseLayerContext.strokeStyle="black",y.mouseLayerContext.beginPath(),y.mouseLayerContext.moveTo(e.start[0],e.start[1]),y.mouseLayerContext.lineTo(k,e.end[1]),y.mouseLayerContext.stroke(),!e.cache){var H=new Set(this.tr.ee.angular([e.start[0],B],[k,A]).filter((function(e){var t,n,a=y.result[e],r=0,i=a.length-1,s=0,o=i;while(r<=i)t=r+i>>1,a[t].x>=S?(s=t,i=t-1):r=t+1;r=0,i=a.length-1;while(r<=i)t=r+i>>1,a[t].x<=O?(o=t,r=t+1):i=t-1;for(var l=s;l<=o;l++)if(a[l].y<minY||a[l].y>maxY)return!1;return!(s&&(n=D(a[s-1],a[s],S).y,n<minY||n>maxY))&&!(o<a.length-1&&(n=D(a[o],a[o+1],S).y,n<minY||n>maxY))})));e.cache=H}}else if("attr"===e.type&&!e.cache){var Y=e.info,P=Y.ind,F=Y.val;console.log(y.aggregatedData,y.data);var N=new Array(y.result.length).fill(0).map((function(e,t){return t})).filter((function(e){var t=y.aggregatedData[e].ref[0],n=y.data[t][P];return n===F}));e.cache=new Set(N)}},hoverBox:function(e){var t;if(y.mouseLayerContext.lineWidth=2,"knn"===e.type)y.mouseLayerContext.beginPath(),(t=y.mouseLayerContext).arc.apply(t,Object(s["a"])(e.start).concat([6,0,2*Math.PI])),y.mouseLayerContext.strokeStyle="red",y.mouseLayerContext.stroke();else if("rnn"===e.type){var n;y.mouseLayerContext.beginPath(),(n=y.mouseLayerContext).arc.apply(n,Object(s["a"])(e.start).concat([e.n,0,2*Math.PI])),y.mouseLayerContext.strokeStyle="red",y.mouseLayerContext.stroke()}else if("brush"===e.type){var a;y.mouseLayerContext.strokeStyle="red",(a=y.mouseLayerContext).strokeRect.apply(a,Object(s["a"])(e.start.map((function(t,n){return Math.min(t,e.end[n])}))).concat(Object(s["a"])(e.end.map((function(t,n){return Math.abs(t-e.start[n])})))))}else if("ang"===e.type){var r=Math.max(e.start[0]+1,e.end[0]),i=(e.end[1]-e.start[1])/(r-e.start[0]),o=Math.atan(i),l=Math.min(.5*Math.PI-1e-4,o+e.n/180*Math.PI),c=Math.max(-.5*Math.PI+1e-4,o-e.n/180*Math.PI),u=Math.tan(l),h=Math.tan(c),d=e.start[1]+u*(r-e.start[0]),f=e.start[1]+h*(r-e.start[0]);y.mouseLayerContext.strokeStyle="red",y.mouseLayerContext.beginPath(),y.mouseLayerContext.moveTo(e.start[0],e.start[1]),y.mouseLayerContext.lineTo(r,f),y.mouseLayerContext.lineTo(r,d),y.mouseLayerContext.closePath(),y.mouseLayerContext.stroke()}},initCanvas:function(e){e.fillStyle="black",e.globalAlpha=1,e.fillRect(0,0,1e3,500),e.clearRect(0,0,1e3,500)},renderBoxes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";this.initCanvas(y.mouseLayerContext);var t=Object(s["a"])(y.querys);if(this.preview&&!this.modify&&t.push(this.preview),console.time("update brush"),t.forEach(this.renderBox),console.timeEnd("update brush"),"mouseLayer"!==e){if(this.initCanvas(y.selectionLayerContext),this.initCanvas(y.repLayerContext),!this.preview){var n=[],a=[];n=t.reduce((function(e,t){return t.hide?e:new Set(Object(s["a"])(e).filter((function(e){return t.cache.has(e)})))}),(t[0]||{cache:new Set}).cache),a=t.reduce((function(e,t){return t.hide?e:new Set([].concat(Object(s["a"])(e),Object(s["a"])(t.cache)))}),(t[0]||{cache:new Set}).cache),this.renderResult(Object(s["a"])(n),Object(s["a"])(a))}console.time("begin calculate rep line and draw line"),this.drawLine(this.getSelectedIds()),console.timeEnd("begin calculate rep line and draw line"),console.log("render boxes ended ==== \n\n")}},getSelectedIds:function(){return"number"===typeof this.selectedQuery?Object(s["a"])(y.querys[this.selectedQuery].cache):"$int"===this.selectedQuery?y.interResult:y.unionResult},renderAxisHelper:function(e){var t=e.offsetX,n=this.upsideDown?e.offsetY:500-e.offsetY,a=this.xScale.invert(t),r=this.yScale.invert(500-n),i="date"==y.inferX?Ee()(a).format("YYYY-MM-DD"):a.toFixed(2),s=this.upsideDown;this.showCursorValue?(this.cursorHelper.selectAll("line").each((function(e,a){m["i"](this).attr("x1",0===a?0:t).attr("y1",0===a?500-n:s?0:500).attr("x2",t).attr("y2",500-n)})),this.cursorHelper.selectAll("text").each((function(e,a){m["i"](this).attr("x",0===a?0:t-(t>930?70:0)).attr("y",0===a?500-n+(n>480?12:0):s?12:500).text(0===a?r.toFixed(2):i)}))):(this.cursorHelper.selectAll("line").attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",0),this.cursorHelper.selectAll("text").text(""))},getColorMap:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[[[253,231,37],[188,223,39],[122,209,81],[67,191,113],[34,168,132],[33,145,141],[42,120,142],[53,96,141],[65,68,135],[72,37,117],[68,1,84]],[[252,253,191],[254,206,145],[254,159,109],[247,111,92],[222,73,104],[182,55,122],[140,41,129],[101,26,128],[59,15,112],[21,14,55],[0,0,4]],[[252,255,164],[246,214,69],[252,165,10],[243,119,26],[221,81,58],[187,55,85],[147,38,103],[107,23,110],[66,10,104],[23,12,59],[0,0,4]],[[240,249,33],[252,206,37],[252,166,54],[242,131,76],[225,100,98],[203,71,121],[177,42,144],[144,13,164],[106,0,168],[66,3,157],[13,8,135]],[[253,234,69],[234,209,86],[202,186,106],[173,164,118],[148,143,120],[127,124,117],[105,105,112],[77,86,109],[43,68,110],[10,50,106],[0,32,81]],[[144,12,0],[186,34,8],[246,95,24],[255,164,35],[222,221,50],[149,251,81],[77,248,132],[39,215,196],[47,157,245],[74,88,221],[35,23,27]],[[213,239,237],[193,232,224],[167,221,209],[139,210,190],[112,198,169],[88,186,145],[68,173,119],[49,156,93],[32,137,70],[14,119,54],[3,100,41]],[[204,221,236],[186,208,228],[168,194,221],[154,176,212],[145,156,201],[141,133,190],[139,109,178],[138,85,166],[135,60,153],[130,34,135],[115,15,113]],[[244,209,102],[213,202,96],[182,195,92],[152,187,89],[124,178,87],[96,166,86],[75,156,83],[63,143,79],[51,131,74],[37,119,64],[20,108,54]],[[244,209,102],[248,190,92],[248,170,76],[245,152,59],[243,133,42],[239,112,27],[226,98,31],[214,83,34],[197,73,35],[177,66,35],[158,58,38]],[[244,209,102],[246,190,89],[249,170,81],[252,150,78],[246,131,75],[238,115,74],[229,98,73],[219,82,71],[207,66,68],[196,49,65],[183,29,62]],[[211,238,206],[197,232,195],[177,225,187],[155,216,187],[130,206,194],[105,194,202],[81,178,205],[60,159,199],[40,138,189],[22,117,177],[11,96,161]],[[253,220,175],[253,207,155],[253,193,138],[253,173,119],[251,149,98],[246,125,83],[238,101,69],[226,73,50],[211,45,30],[191,19,13],[167,4,3]],[[219,216,234],[200,206,228],[176,195,222],[147,183,216],[114,172,209],[84,159,200],[56,146,187],[28,136,163],[9,127,135],[2,115,107],[1,99,83]],[[219,218,235],[200,206,228],[177,195,222],[151,183,216],[123,172,209],[91,159,201],[58,144,192],[30,127,183],[11,112,171],[5,97,153],[4,82,129]],[[220,201,226],[211,179,215],[206,158,204],[209,134,192],[218,107,178],[225,77,160],[226,49,137],[217,30,111],[198,17,89],[171,7,73],[143,2,58]],[[252,207,204],[252,190,192],[250,169,184],[249,143,175],[245,113,165],[236,83,157],[219,54,149],[196,27,138],[169,8,128],[141,1,121],[112,1,116]],[[239,249,189],[219,241,180],[189,229,181],[148,213,185],[105,197,190],[69,180,194],[44,158,192],[33,130,184],[33,99,170],[35,71,156],[28,49,133]],[[228,244,172],[209,236,160],[185,226,148],[158,214,136],[128,201,124],[98,187,110],[71,170,94],[50,151,80],[32,131,68],[14,114,59],[3,96,52]],[[254,234,161],[254,221,132],[254,204,99],[254,183,70],[252,160,49],[246,137,33],[235,114,21],[219,94,11],[197,76,5],[171,61,3],[143,50,4]],[[254,224,135],[254,209,111],[254,189,89],[254,168,73],[253,144,62],[252,115,53],[249,82,43],[238,52,35],[222,27,32],[202,11,34],[175,2,37]]];return t[e?this.colormapOverlayIndexCache:this.colormapIndexCache]},renderColorMap:function(){document.getElementById("color-map").style.background="linear-gradient(to right, ".concat(this.getColorMap().map((function(e,t,n){return"rgb(".concat(e.join(", "),") ").concat((t/(n.length-1)*100).toFixed(0),"%")})).join(", "),")")},renderColorMapOverlay:function(){document.getElementById("color-map-overlay").style.background="linear-gradient(to right, ".concat(this.getColorMap(!0).map((function(e,t,n){return"rgb(".concat(e.join(", "),") ").concat((t/(n.length-1)*100).toFixed(0),"%")})).join(", "),")")},rgb:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=n?this.colormapOverlayIndexCache:this.colormapIndexCache;if(null===(t=Te[a])||void 0===t?void 0:t[Math.round(100*e)])return Te[a][Math.round(100*e)];var r=this.getColorMap(n),i=Math.floor(10*e);if(e<=0)return r[0];if(e>=1)return r[10];void 0===r[i]&&console.log(r,i,e);var s=r[i].map((function(t,n){return t+(r[i+1][n]-t)*(10*e-i)}));return Te[a]||(Te[a]={}),Te[a][Math.round(100*e)]=s,s},renderAllDensity:function(e){var t=this,n=document.getElementById("canvas").getContext("2d");if(!y.slopePixelCache){var a=new Array(1e3).fill().map((function(){return new Array(500).fill().map((function(){return{}}))}));for(var r in y.result)for(var i=y.result[r],s=0;s<i.length-1;s++)H([i[s],i[s+1]],a,r,(i[s+1].y-i[s].y)/(i[s+1].x-i[s].x));y.slopePixelCache=a}console.time("temp canvas");var o=new Float32Array(5e5).map((function(e,n){var a=n%500,r=Math.floor(n/500),i=Object.values(y.slopePixelCache[r][a]);return t.normalizeDensity?i.reduce((function(e,t){return e+t}),0):i.length}));e&&(this.initDensityBufferCache=o),console.timeEnd("temp canvas"),console.time("render"),n.fillStyle="black",n.globalAlpha=1,n.fillRect(0,0,1e3,500),n.clearRect(0,0,1e3,500);var l=new Uint8ClampedArray(2e6),c=new ImageData(l,1e3,500),u=Math.ceil(!e&&this.maxDensity||o.reduce((function(e,t){return Math.max(e,t)})));this.maxDensity=u,e&&(this.maxOverlayDensity=u);for(var h={},d=0;d<1e3;d++)for(var f=0;f<500;f++){var p=Math.round(o[500*d+f]/u*100);h[p]||(h[p]=this.rgb(p/100));var v=h[p];l.set(v,4*(1e3*f+d)),l[4*(1e3*f+d)+3]=p<=0?0:255}n.putImageData(c,0,0),console.timeEnd("render"),e&&(this.initDensityMaxCache=u,this.initDensityCache=n.getImageData(0,0,1e3,500)),this.currentDensityMax=u,this.currentDensity=n.getImageData(0,0,1e3,500)},renderDensity:function(){var e=this.getSelectedIds(),t={};e.forEach((function(e){return t[e]=1}));var n=!1;for(var a in this.layers){var r=this.layers[a];"selected density"===r.name&&r.opacity>0&&(n=!0)}if(n){var i=document.getElementById("selectionCanvas").getContext("2d");console.time("render"),i.fillStyle="black",i.globalAlpha=1,i.fillRect(0,0,1e3,500),i.clearRect(0,0,1e3,500);for(var s=new Uint8ClampedArray(2e6),o=new ImageData(s,1e3,500),l=this.maxOverlayDensity,c=0;c<1e3;c++)for(var u=0;u<500;u++){var h=0,d=Object.entries(y.slopePixelCache[c][u]);h=this.normalizeDensity?d.reduce((function(e,n){return e+(t[n[0]]?n[1]:0)}),0):d.reduce((function(e,n){return e+(t[n[0]]?1:0)}),0);var f=h/l,p=this.rgb(f,!0);s.set(p,4*(1e3*u+c)),s[4*(1e3*u+c)+3]=f<=0?0:255}i.putImageData(o,0,0),console.timeEnd("render"),this.currentDensityMax=l,this.currentDensity=i.getImageData(0,0,1e3,500)}},rearrangeLayer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[{name:"raw_lines",opacity:0,zIndex:0},{name:"canvas",opacity:1,zIndex:1},{name:"selectionCanvas",opacity:0,zIndex:2},{name:"selectionLayer",opacity:.4,zIndex:3},{name:"rep_layer",opacity:1,zIndex:4}];for(var t in e){var n=e[t],a=document.getElementById(n.id);a.style.opacity=n.opacity,a.style.zIndex="".concat(6-t)}},setReverseY:function(){console.log("before set",this.yScale.range()),this.yScale.range(this.upsideDown?[0,500]:[500,0]),console.log("after set",this.yScale.range());for(var e="scaleY(".concat(this.upsideDown?-1:1,")"),t=["canvas","selectionCanvas","selectionLayer","rep_layer","raw_lines","mouseLayer"],n=0,a=t;n<a.length;n++){var r=a[n];document.getElementById(r).style.transform=e}this.svg.select("#xaxis").remove(),this.svg.select("#yaxis").remove(),this.svg.append("g").attr("id","yaxis").attr("transform","translate(30,20)").call(y.yAxis),this.svg.append("g").attr("id","xaxis").attr("transform","translate(30,".concat(this.upsideDown?20:520,")")).call(this.upsideDown?y.xAxisR:y.xAxis)},getStaticInformation:function(e){var t=this;if(!e||!e.length)return{};var n=m["f"](e,(function(e){return y.result[e][0].x})),a=m["d"](e,(function(e){return y.result[e][0].x})),r=m["f"](e,(function(e){return m["f"](y.result[e],(function(e){return t.yScaleC.invert(e.y)}))})),i=m["d"](e,(function(e){return m["d"](y.result[e],(function(e){return t.yScaleC.invert(e.y)}))})),s=e.map((function(e){return m["e"](y.result[e],(function(e){return t.yScaleC.invert(e.y)}))})),o=m["e"](s),l=s.length>1?m["j"](s):m["j"](y.result[e[0]],(function(e){return t.yScaleC.invert(e.y)}));return{minT:Ee()(this.xScale.invert(n)).format("YYYY-M-D"),maxT:Ee()(this.xScale.invert(a)).format("YYYY-M-D"),minV:r.toFixed(2),maxV:i.toFixed(2),count:e.length,points:e.reduce((function(e,t){var n,a;return null!==(n=e+(null===(a=y.result[t])||void 0===a?void 0:a.length))&&void 0!==n?n:0}),0),mean:o.toFixed(2),var:l.toFixed(2)}},getColor:function(e){if(this.colorCache[e])return this.colorCache[e];function t(e,t,n){var a=[e,t,n].map((function(e){return e/=255,e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}));return.2126*a[0]+.7152*a[1]+.0722*a[2]}function n(e,n){var a=t(e[0],e[1],e[2]),r=t(n[0],n[1],n[2]),i=Math.max(a,r),s=Math.min(a,r);return(i+.05)/(s+.05)}var a=Ae()(e),r=new Array(3).fill(0).map((function(){return Math.floor(255*a())}));while(n(r,[255,255,255])<3)r=new Array(3).fill(0).map((function(){return Math.floor(255*a())}));return this.colorCache[e]=r,r},calcRepLines:function(e){var t=this,n=this.repCount,a=e.map((function(e){return{id:e,w:t.calcLineWeight(e),cur:R(y.result[e].filter((function(e){return y.querys.length<=0&&!y.preview||(y.preview?[y.preview]:y.querys).find((function(t){if("knn"===t.type)return!0;if("rnn"===t.type)return Math.sqrt(Math.pow(e.x-t.start[0],2)+Math.pow(e.y-t.start[1],2))<=t.n;if("brush"===t.type){var n=Math.min(t.start[0],t.end[0]),a=Math.min(t.start[1],t.end[1]),r=Math.max(t.start[0],t.end[0]),i=Math.max(t.start[1],t.end[1]);return e.x>=n&&e.y>=a&&e.x<=r&&e.y<=i}if("ang"===t.type){var s=Math.min(t.start[0],t.end[0]),o=Math.max(t.start[0],t.end[0]);return e.x>=s&&e.x<=o}}))})))}})).sort((function(e,t){return t.w[0]*Math.sqrt(t.w[1])-e.w[0]*Math.sqrt(e.w[1])}));return console.log("this is line weight"),console.log(a),a.reduce((function(e,a){return e.length>=n||a.w[1]<1e3/3||e.find((function(e){return q(e.cur,a.cur)<t.diverse}))||e.push(a),e}),[]).map((function(e){return e.id}))},drawLine:function(e){if(this.preview&&(e=e.slice(0,5)),!this.preview){var t,n=Object(c["a"])(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,r=y.result[a];y.selectionLayerContext.strokeStyle="rgb(".concat(this.getColor(a).join(","),")"),y.selectionLayerContext.beginPath(),y.selectionLayerContext.moveTo(r[0].x,r[0].y);var i,o=Object(c["a"])(r);try{for(o.s();!(i=o.n()).done;){var l=i.value;y.selectionLayerContext.lineTo(l.x,l.y)}}catch(m){o.e(m)}finally{o.f()}y.selectionLayerContext.stroke()}}catch(m){n.e(m)}finally{n.f()}y.selectedLines=e}this.preview?e=Object(s["a"])(this.preview.cache):y.querys.length||(e=new Array(y.result.length).fill(0).map((function(e,t){return t})));var u=this.calcRepLines(e);y.querys.length||(y.globalRep=u);for(var h in u){y.repLayerContext.strokeStyle="rgb(".concat(this.getColor(u[h]).join(","),")");var d=y.result[u[h]];y.repLayerContext.beginPath(),y.repLayerContext.moveTo(d[0].x,d[0].y);var f,p=Object(c["a"])(d);try{for(p.s();!(f=p.n()).done;){var v=f.value;y.repLayerContext.lineTo(v.x,v.y)}}catch(m){p.e(m)}finally{p.f()}y.repLayerContext.stroke()}},calcLineWeight:function(e){for(var t=this,n=0,a=0,r=0,i=y.querys.find((function(e){return"brush"===e.type})),s=y.querys.filter((function(e){return"brush"===e.type})).map((function(e){return[Math.min(e.start[0],e.end[0]),Math.max(e.start[0],e.end[0]),Math.min(e.start[1],e.end[1]),Math.max(e.start[1],e.end[1])]})),o=y.result[e],l=function(e){var l=Math.floor(o[e+1].x),c=Math.floor(o[e+1].y),u=Math.floor(o[e].x),h=Math.floor(o[e].y),d=Math.abs(l-u),f=u<l?1:-1,p=-Math.abs(c-h),v=h<c?1:-1,y=d+p,m=void 0,x=!1,g=u,b=h,w=0;while(!x)(!i||s.find((function(e){return e[0]<=g&&e[1]>=g&&e[2]<=b&&e[3]>=b})))&&g>=0&&g<1e3&&b>=0&&b<500&&(n+=t.initDensityBufferCache[500*g+b],a++,g!==w&&(w=g,r++)),g===l&&b===c?x=!0:(m=2*y,m>=p&&(y+=p,g+=f),m<=d&&(y+=d,b+=v))},c=0;c<o.length-1;c++)l(c);var u=n;return n/=a,isFinite(n)&&!isNaN(n)||(console.log(n,a,u),n=1e-5),i||(y.weightCache[e]=[n*Math.sqrt(r),o[o.length-1].x-o[0].x]),[n*Math.sqrt(r),o[o.length-1].x-o[0].x]}},mounted:function(){var e=this;y.querys=[],y.weightCache=[],y.layers=this.layers,y.upsideDown=this.upsideDown,this.headers=y.headers.map((function(e,t){return{title:e,key:t,minWidth:150}}));var t=new Map,n=[];y.headers.forEach((function(){n.push(new Set)})),y.data.forEach((function(e){e.forEach((function(e,t){n[t].add(e)}))})),y.headers.forEach((function(e,a){t.set(e,Object(s["a"])(n[a]))})),y.headerMap=t;var a=y.aggregatedData;console.log(a);var r=m["f"](a,(function(t){return m["f"](t[e.timeIndex])})),i=m["d"](a,(function(t){return m["d"](t[e.timeIndex])})),o=m["f"](a,(function(t){return m["f"](t[e.valueIndex])})),l=m["d"](a,(function(t){return m["d"](t[e.valueIndex])}));console.log(r,i,o,l);var c=m["g"]().domain([r,i]).range([0,1e3]);this.xScale="date"==y.inferX?m["h"]().domain([new Date(3600*r*24*1e3),new Date(3600*i*24*1e3)]).range([0,1e3]):c,this.yScale=m["g"]().domain([o,l]).range([500,0]),this.yScaleC=m["g"]().domain([o,l]).range([500,0]);var u=a.map((function(t){var n=[];return t[e.timeIndex].forEach((function(a,r){n.push({x:c(a),y:e.yScale(t[e.valueIndex][r])})})),n}));y.result=u;this.tr={},this.tr.ee=new ee(u),this.renderAllDensity(!0),this.renderDensity(),y.selectionLayerContext=document.getElementById("selectionLayer").getContext("2d"),y.mouseLayerContext=document.getElementById("mouseLayer").getContext("2d"),y.repLayerContext=document.getElementById("rep_layer").getContext("2d"),y.rawLinesLayerContext=document.getElementById("raw_lines").getContext("2d"),this.svg=m["i"](document.getElementById("axisHelper")),this.cursorHelper=m["i"](document.getElementById("cursorHelper"));var h=m["a"](this.xScale),d=m["c"](this.xScale),f=m["b"](this.yScale);y.yAxis=f,y.xAxis=h,y.xAxisR=d,this.svg.append("g").attr("id","xaxis").attr("transform","translate(30,520)").call(h),this.svg.append("g").attr("id","yaxis").attr("transform","translate(30,20)").call(f),this.renderBoxes(),this.drawRawLines(),this.rearrangeLayer(this.layers),this.cnt++,this.colormapIndexCache=1,this.renderColorMap(),this.renderColorMapOverlay();var p=document.getElementById("informationTable");p.addEventListener("mousemove",(function(t){var n=null;if(t.path.length>=18&&(n=t.path[t.path.length-18]),n&&"tr"===n.tagName.toLowerCase()&&"tbody"===n.parentNode.tagName.toLowerCase()){for(var a,r=n.parentNode.children,i=0,s=0;s<r.length;s++){var o,l=r[s];if((null===(o=l.className)||void 0===o?void 0:o.includes("ivu-table-row"))&&i++,l===n){a=i-1;break}}if(a>=y.querys.length)return e.renderBoxes("mouseLayer"),void(e.hoveringInd=null);e.hoveringQuery(a)}else e.hoveringInd=null,e.renderBoxes("mouseLayer")})),p.addEventListener("mouseleave",(function(){e.renderBoxes("mouseLayer"),e.hoveringInd=null}))},beforeDestroy:function(){this.contextHandler&&this.contextHandler.destroy()}},qe=Re,He=(n("0c4e"),Object(M["a"])(qe,d,f,!1,null,null,null)),Ye=He.exports,Pe=n("86ec"),Fe=n.n(Pe),Ne=n("bc3a"),We=n.n(Ne),$e=function(e,t,n,a){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function s(e){try{l(a.next(e))}catch(t){i(t)}}function o(e){try{l(a["throw"](e))}catch(t){i(t)}}function l(e){e.done?n(e.value):r(e.value).then(s,o)}l((a=a.apply(e,t||[])).next())}))},Qe=function(e,t){var n,a,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(e){return function(t){return l([e,t])}}function l(i){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,a&&(r=2&i[0]?a["return"]:i[0]?a["throw"]||((r=a["return"])&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,a=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(o){i=[6,o],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},Xe=[n("9833").default,n("8802").default,n("51f2").default,n("5a12").default,n("69ee").default];function Ve(e){return $e(this,void 0,void 0,(function(){var t,n;return Qe(this,(function(a){switch(a.label){case 0:return[4,We.a.get(Xe[e-1])];case 1:return t=a.sent(),n=Fe()(t.data,{skip_empty_lines:!0}),[2,n]}}))}))}function Ue(e){return $e(this,void 0,void 0,(function(){return Qe(this,(function(t){return[2,new Promise((function(t){var n=new FileReader;n.onload=function(){t(Fe()(n.result,{skip_empty_lines:!0}))},n.readAsText(e)}))]}))}))}var Ke=n("aeb1"),Ge=n.n(Ke);function Je(e,t){switch(t){case"string":return 0;case"date":return Math.floor(new Date(e)/864e5);case"number":return parseFloat(e)}}var Ze={name:"App",components:{CanvasBox:Ye},data:function(){return{headers:[],inferTypes:[],aggregateAttr:0,timeAttr:0,valueAttr:0,chartConfigs:[],filters:[],layers:[{id:"rep_layer",name:"representative line",opacity:1},{id:"selectionCanvas",name:"selected density",opacity:0},{id:"selectionLayer",name:"selected line",opacity:.4},{id:"canvas",name:"density",opacity:1},{id:"raw_lines",name:"raw line",opacity:0}]}},methods:{eventHandler:function(e){var t=this;this.$Spin.show(),e.startsWith("1")?Ve(e.split("-")[1]).then((function(e){t.$Spin.hide(),t.preProcessData(e),t.generateCharts()})):"2"==e&&(this.$refs.upload.handleClick(),this.$Spin.hide())},readFileHandler:function(e){var t=this;return this.$Spin.show(),Ue(e).then((function(e){t.$Spin.hide(),t.preProcessData(e),t.generateCharts()})),!1},preProcessData:function(e){this.headers=e[0],y.headers=e[0],y.data=e.slice(1),e.length>1&&(this.inferTypes=e[1].map((function(e){if(e.includes("-")||e.includes("/")){var t=new Date(e).toString();return t.startsWith("Invalid")?"string":"date"}return/^\d*(\.\d*)?$/.test(e)?"number":"string"})),this.aggregateAttr=this.inferTypes.indexOf("string"),this.timeAttr=this.inferTypes.indexOf("date"),this.aggregateAttr<0&&(this.aggregateAttr=0),this.timeAttr<0&&(this.timeAttr=this.inferTypes.indexOf("number"),this.aggregateAttr===this.timeAttr&&(this.timeAttr=this.inferTypes.indexOf("number",this.aggregateAttr+1))),this.timeAttr<0&&(this.timeAttr=0),this.valueAttr=this.inferTypes.indexOf("number"),this.valueAttr!==this.timeAttr&&this.valueAttr!==this.aggregateAttr||(this.valueAttr=this.inferTypes.indexOf("number",this.timeAttr+1)),this.valueAttr<0&&(this.valueAttr=0))},generateCharts:function(){var e=this;if(this.$Spin.show(),this.headers[this.aggregateAttr]!=(this.chartConfigs.length&&this.chartConfigs[0].aggregateName)||!this.chartConfigs.find((function(t){return t.valueIndex===e.valueAttr}))){var t;y.aggregatedData=[];var n=new Map,a=(t={},Object(u["a"])(t,this.timeAttr,this.inferTypes[this.timeAttr]),Object(u["a"])(t,this.valueAttr,this.inferTypes[this.valueAttr]),t);y.data.forEach((function(t,r){var i,s,o=t[e.aggregateAttr];n.has(o)?i=n.get(o):(s={ref:[]},Object(u["a"])(s,e.timeAttr,[]),Object(u["a"])(s,e.valueAttr,[]),i=s,n.set(o,i));i.ref.push(r),i[e.timeAttr].push(Je(t[e.timeAttr],a[e.timeAttr])),i[e.valueAttr].push(Je(t[e.valueAttr],a[e.valueAttr]))}));var r,i=Object(c["a"])(n.entries());try{for(i.s();!(r=i.n()).done;){var s=Object(l["a"])(r.value,2),h=s[0],d=s[1];y.aggregatedData.push(Object.entries(d).reduce((function(e,t){return Object(o["a"])(Object(o["a"])({},e),{},Object(u["a"])({},t[0],new Float32Array(t[1])))}),{key:h}))}}catch(f){i.e(f)}finally{i.f()}n.clear()}this.valueAttr===this.timeAttr?this.chartConfigs=[]:(this.chartConfigs=[{aggregateIndex:this.aggregateAttr,timeIndex:this.timeAttr,valueIndex:this.valueAttr,aggregateName:this.headers[this.aggregateAttr],timeName:this.headers[this.timeAttr],valueName:this.headers[this.valueAttr],filter:void 0,emitFilter:void 0}],y.aggregateName=this.headers[this.aggregateAttr],y.slopePixelCache=null,y.inferX=this.inferTypes[this.timeAttr]),this.filters=this.chartConfigs.map((function(e){})),this.$Spin.hide()},handleFilterChange:function(e,t){var n=this;if(this.filters.splice(e,1,t),this.filters.find((function(e){return e}))){var a=new Float32Array(new Set(this.filters.reduce((function(e,t){return[].concat(Object(s["a"])(e),Object(s["a"])(t||[]))}),[]).filter((function(e){return!n.filters.find((function(t){return!(t&&t.includes(e))}))}))));this.chartConfigs.forEach((function(e){n.$set(e,"filter",a)}))}else this.chartConfigs.forEach((function(e){n.$set(e,"filter",void 0)}))},exportFig:function(){h(y.layers.map((function(e){return document.getElementById(e.id)})).reverse(),y.upsideDown,y.layers.map((function(e){return e.opacity})).reverse())},exportData:function(e){var t=this,n=y[e?"repIds":"selectedLines"];if(n&&n.length){var a="",r=-1,i=y.data.filter((function(e){return e[t.aggregateAttr]!==a&&(r++,a=e[t.aggregateAttr]),!!n.includes(r)}));Ge()(y.headers.join(",")+"\n"+i.map((function(e){return e.join(",")})).join("\n"),"export.csv","text/csv")}}}},et=Ze,tt=(n("5c0b"),Object(M["a"])(et,r,i,!1,null,null,null)),nt=tt.exports,at=n("f825"),rt=n.n(at),it=(n("f8ce"),n("3250")),st=n.n(it);a["default"].use(rt.a,{locale:st.a}),a["default"].config.productionTip=!1,new a["default"]({render:function(e){return e(nt)}}).$mount("#app");var ot=document.createElement("canvas"),lt=ot.getContext("webgl"),ct=lt.getExtension("WEBGL_debug_renderer_info");lt.getParameter(ct.UNMASKED_RENDERER_WEBGL).toLowerCase()},"5a12":function(e,t,n){"use strict";n.r(t),t["default"]=n.p+"795f7099aa693d52f5fcf4efb9c47976.csv"},"5c0b":function(e,t,n){"use strict";var a=n("9c0c"),r=n.n(a);r.a},"69ee":function(e,t,n){"use strict";n.r(t),t["default"]=n.p+"81972e1a2dcb8f79c4645c60d58383bf.csv"},"72cd":function(e,t,n){"use strict";var a=n("936d"),r=n.n(a);r.a},8802:function(e,t,n){"use strict";n.r(t),t["default"]=n.p+"455214f84fb18c0faf82859fa62bd0ae.csv"},"936d":function(e,t,n){},9833:function(e,t,n){"use strict";n.r(t),t["default"]=n.p+"b9c8219653d8ec39d5473283116881ee.csv"},"9c0c":function(e,t,n){}});
//# sourceMappingURL=app.aed2ec66.js.map